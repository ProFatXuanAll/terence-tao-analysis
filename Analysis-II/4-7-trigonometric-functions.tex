\section{Trigonometric functions}\label{sec:4.7}

\begin{note}
  There are several other useful special functions in mathematics, such as the hyperbolic trigonometric functions and hypergeometric functions, the gamma and zeta functions, and elliptic functions, but they occur more rarely than trigonometric functions.
\end{note}

\begin{note}
  Trigonometric functions are often defined using geometric concepts, notably those of circles, triangles, and angles.
  However, it is also possible to define them using more analytic concepts, and in particular the (complex) exponential function.
\end{note}

\begin{defn}[Trigonometric functions]\label{4.7.1}
  If \(z\) is a complex number, then we define
  \[
    \cos(z) \coloneqq \dfrac{e^{iz} + e^{-iz}}{2}
  \]
  and
  \[
    \sin(z) \coloneqq \dfrac{e^{iz} - e^{-iz}}{2i}.
  \]
  We refer to \(\cos\) and \(\sin\) as the \emph{cosine} and \emph{sine} functions respectively.
\end{defn}

\begin{note}
  \cref{4.7.1} were discovered by Leonhard Euler (1707 -- 1783) in 1748, who recognized the link between the complex exponential and the trigonometric functions.
  Since we have defined the sine and cosine for complex numbers \(z\), we automatically have defined them also for real numbers \(x\).
  In fact in most applications one is only interested in the trigonometric functions when applied to real numbers.
\end{note}

\begin{ac}\label{ac:4.7.1}
  From \cref{4.6.15}, we have
  \[
    e^{i z} = 1 + i z - \dfrac{z^2}{2!} - \dfrac{i z^3}{3!} + \dfrac{z^4}{4!} + \dots
  \]
  and
  \[
    e^{- i z} = 1 - i z - \dfrac{z^2}{2!} + \dfrac{i z^3}{3!} + \dfrac{z^4}{4!} - \dots
  \]
  and so from the above formulae we have
  \[
    \cos(z) = 1 - \dfrac{z^2}{2!} + \dfrac{z^4}{4!} - \dots = \sum_{n = 0}^\infty \dfrac{(-1)^n z^{2n}}{(2n)!}
  \]
  and
  \[
    \sin(z) = z - \dfrac{z^3}{3!} + \dfrac{z^5}{5!} - \dots = \sum_{n = 0}^\infty \dfrac{(-1)^n z^{2n + 1}}{(2n + 1)!}.
  \]
  In particular, \(\cos(x)\) and \(\sin(x)\) are always real whenever \(x\) is real.
  From the ratio test we see that the two power series \(\sum_{n = 0}^\infty \dfrac{(-1)^n x^{2n}}{(2n)!}\), \(\sum_{n = 0}^\infty \dfrac{(-1)^n x^{2n + 1}}{(2n + 1)!}\) are absolutely convergent for every \(x\), thus \(\sin(x)\) and \(\cos(x)\) are real analytic at \(0\) with an infinite radius of convergence.
  From \cref{ex:4.2.8} we thus see that the sine and cosine functions are real analytic on all of \(\R\).
  (They are also complex analytic on all of \(\C\), but we will not pursue this matter in this text.)
  In particular the sine and cosine functions are continuous and differentiable (see \cref{4.2.6}).
\end{ac}

\begin{thm}[Trigonometric identities]\label{4.7.2}
  Let \(x, y\) be real numbers.
  \begin{enumerate}
    \item We have \(\big(\sin(x)\big)^2 + \big(\cos(x)\big)^2 = 1\).
          In particular, we have \(\sin(x) \in [-1, 1]\) and \(\cos(x) \in [-1, 1]\) for all \(x \in \R\).
    \item We have \(\sin'(x) = \cos(x)\) and \(\cos'(x) = -\sin(x)\).
    \item We have \(\sin(-x) = -\sin(x)\) and \(\cos(-x) = \cos(x)\).
    \item We have \(\cos(x + y) = \cos(x) \cos(y) - \sin(x) \sin(y)\) and \(\sin(x + y) = \sin(x) \cos(y) + \cos(x) \sin(y)\).
    \item We have \(\sin(0) = 0\) and \(\cos(0) = 1\).
    \item We have \(e^{i x} = \cos(x) + i \sin(x)\) and \(e^{- i x} = \cos(x) - i \sin(x)\).
          In particular \(\cos(x) = \Re(e^{i x})\) and \(\sin(x) = \Im(e^{i x})\).
  \end{enumerate}
\end{thm}

\begin{proof}{(a)}
  Let \(x \in \R\).
  Then we have
  \begin{align*}
     & \big(\sin(x)\big)^2 + \big(\cos(x)\big)^2                                                                                                                                           \\
     & = \bigg(\dfrac{e^{i x} - e^{- i x}}{2i}\bigg)^2 + \bigg(\dfrac{e^{i x} + e^{- i x}}{2}\bigg)^2                                                     &  & \by{4.7.1}                  \\
     & = \dfrac{e^{i x} e^{i x} - 2 e^{i x} e^{- i x} + e^{- i x} e^{- i x}}{-4} + \dfrac{e^{i x} e^{i x} + 2 e^{i x} e^{- i x} + e^{- i x} e^{- i x}}{4} &  & \by{4.6.5}                  \\
     & = \dfrac{4 e^{i x} e^{- i x}}{4}                                                                                                                   &  & \by{4.6.4}                  \\
     & = e^{i x} e^{- i x}                                                                                                                                                                 \\
     & = e^{i x - i x}                                                                                                                                    &  & \by{ex:4.6.16}              \\
     & = e^0                                                                                                                                                                               \\
     & = 1.                                                                                                                                               &  & \text{(by \cref{4.5.2}(d))}
  \end{align*}
  By \cref{ac:4.7.1} we know that \(\sin(x), \cos(x) \in \R\) when \(x \in \R\).
  Thus we have
  \begin{align*}
             & \begin{dcases}
                 \big(\sin(x)\big)^2 \leq 1 \\
                 \big(\cos(x)\big)^2 \leq 1
               \end{dcases} \\
    \implies & \begin{dcases}
                 \sin(x) \in [-1, 1] \\
                 \cos(x) \in [-1, 1]
               \end{dcases}
  \end{align*}
\end{proof}

\begin{proof}{(b)}
  Let \(x \in \R\).
  By \cref{ac:4.7.1} we know that \(\sin'\) and \(\cos'\) are well-defined.
  Then we have
  \begin{align*}
     & \sin'(x)                                                                                                                                                     \\
     & = \bigg(y \mapsto \dfrac{e^{i y} - e^{- i y}}{2i}\bigg)'(x)                                                                 &  & \by{4.7.1}                  \\
     & = \bigg(y \mapsto \dfrac{\sum_{n = 0}^\infty \dfrac{(i y)^n}{n!} - \sum_{n = 0}^\infty \dfrac{(- i y)^n}{n!}}{2i}\bigg)'(x) &  & \by{4.6.15}                 \\
     & = \bigg(y \mapsto \sum_{n = 0}^\infty \dfrac{(i y)^n - (- i y)^n}{(2i) (n!)}\bigg)'(x)                                      &  & \by{4.6.14}                 \\
     & = \bigg(y \mapsto \sum_{n = 0}^\infty \dfrac{i^n y^n - (-1)^n i^n y^n}{(2i) (n!)}\bigg)'(x)                                 &  & \by{4.6.6}                  \\
     & = \Bigg(y \mapsto \sum_{n = 0}^\infty \bigg(\dfrac{\big(1 - (-1)^n\big) i^n}{(2i) (n!)} y^n\bigg)\Bigg)'(x)                 &  & \by{4.6.6}                  \\
     & = \Bigg(y \mapsto \sum_{n = 1}^\infty \bigg(\dfrac{n \big(1 - (-1)^n\big) i^n}{(2i) (n!)} y^{n - 1}\bigg)\Bigg)(x)          &  & \text{(by \cref{4.1.6}(d))} \\
     & = \Bigg(y \mapsto \sum_{n = 1}^\infty \bigg(\dfrac{\big(1 - (-1)^n\big) i^n}{(2i) (n - 1)!} y^{n - 1}\bigg)\Bigg)(x)                                         \\
     & = \bigg(y \mapsto 1 - \dfrac{y^2}{2!} + \dfrac{y^4}{4!} - \dfrac{y^6}{6!} + \dots\bigg)(x)                                                                   \\
     & = \bigg(y \mapsto \sum_{n = 0}^\infty \dfrac{(-1)^n y^{2n}}{(2n)!}\bigg)(x)                                                                                  \\
     & = \cos(x)                                                                                                                   &  & \by{ac:4.7.1}
  \end{align*}
  and
  \begin{align*}
     & \cos'(x)                                                                                                                                                    \\
     & = \bigg(y \mapsto \dfrac{e^{i y} + e^{- i y}}{2}\bigg)'(x)                                                                 &  & \by{4.7.1}                  \\
     & = \bigg(y \mapsto \dfrac{\sum_{n = 0}^\infty \dfrac{(i y)^n}{n!} + \sum_{n = 0}^\infty \dfrac{(- i y)^n}{n!}}{2}\bigg)'(x) &  & \by{4.6.15}                 \\
     & = \bigg(y \mapsto \sum_{n = 0}^\infty \dfrac{(i y)^n + (- i y)^n}{2 (n!)}\bigg)'(x)                                        &  & \by{4.6.14}                 \\
     & = \bigg(y \mapsto \sum_{n = 0}^\infty \dfrac{i^n y^n + (-1)^n i^n y^n}{2 (n!)}\bigg)'(x)                                   &  & \by{4.6.6}                  \\
     & = \Bigg(y \mapsto \sum_{n = 0}^\infty \bigg(\dfrac{\big(1 + (-1)^n\big) i^n}{2 (n!)} y^n\bigg)\Bigg)'(x)                   &  & \by{4.6.6}                  \\
     & = \Bigg(y \mapsto \sum_{n = 1}^\infty \bigg(\dfrac{n \big(1 + (-1)^n\big) i^n}{2 (n!)} y^{n - 1}\bigg)\Bigg)(x)            &  & \text{(by \cref{4.1.6}(d))} \\
     & = \Bigg(y \mapsto \sum_{n = 1}^\infty \bigg(\dfrac{\big(1 + (-1)^n\big) i^n}{2 (n - 1)!} y^{n - 1}\bigg)\Bigg)(x)                                           \\
     & = \bigg(y \mapsto -y + \dfrac{y^3}{3!} - \dfrac{y^5}{5!} + \dfrac{y^7}{7!} + \dots\bigg)(x)                                                                 \\
     & = \bigg(y \mapsto \sum_{n = 0}^\infty \dfrac{(-1)^{n + 1} y^{2n + 1}}{(2n + 1)!}\bigg)(x)                                                                   \\
     & = \Bigg(y \mapsto -\bigg(\sum_{n = 0}^\infty \dfrac{(-1)^n y^{2n + 1}}{(2n + 1)!}\bigg)\Bigg)(x)                           &  & \by{4.6.14}                 \\
     & = \big(y \mapsto -\sin(y)\big)(x)                                                                                          &  & \by{ac:4.7.1}               \\
     & = -\sin(x).
  \end{align*}
\end{proof}

\begin{proof}{(c)}
  Let \(x \in \R\).
  Then we have
  \begin{align*}
    \sin(-x) & = \dfrac{e^{i (-x)} - e^{- i (-x)}}{2i} &  & \by{4.7.1} \\
             & = \dfrac{e^{- i x} - e^{i x}}{2i}       &  & \by{4.6.6} \\
             & = -\dfrac{e^{i x} - e^{- i x}}{2i}      &  & \by{4.6.6} \\
             & = -\sin(x)                              &  & \by{4.7.1}
  \end{align*}
  and
  \begin{align*}
    \cos(-x) & = \dfrac{e^{i (-x)} + e^{- i (-x)}}{2} &  & \by{4.7.1} \\
             & = \dfrac{e^{- i x} + e^{i x}}{2}       &  & \by{4.6.6} \\
             & = \dfrac{e^{i x} + e^{- i x}}{2}       &  & \by{4.6.4} \\
             & = \cos(x).                             &  & \by{4.7.1}
  \end{align*}
\end{proof}

\begin{proof}{(d)}
  Let \(x, y \in \R\).
  Then we have
  \begin{align*}
     & \sin(x) \cos(y) + \cos(x) \sin(y)                                                                                                                      \\
     & = \dfrac{e^{i x} - e^{- i x}}{2 i} \dfrac{e^{i y} + e^{- i y}}{2} + \dfrac{e^{i x} + e^{- i x}}{2} \dfrac{e^{i y} - e^{- i y}}{2i} &  & \by{4.7.1}     \\
     & = \dfrac{e^{i x} e^{i y} + e^{i x} e^{- i y} - e^{- i x} e^{i y} - e^{- i x} e^{- i y}}{4i}                                        &  & \by{4.6.6}     \\
     & \quad + \dfrac{e^{i x} e^{i y} - e^{i x} e^{- i y} + e^{- i x} e^{i y} - e^{- i x} e^{- i y}}{4i}                                                      \\
     & = \dfrac{2 e^{i x} e^{i y} - 2 e^{- i x} e^{- i y}}{4i}                                                                            &  & \by{4.6.4}     \\
     & = \dfrac{e^{i x} e^{i y} - e^{- i x} e^{- i y}}{2i}                                                                                &  & \by{4.6.12}    \\
     & = \dfrac{e^{i x + i y} - e^{- i x - i y}}{2i}                                                                                      &  & \by{ex:4.6.16} \\
     & = \dfrac{e^{i (x + y)} - e^{- i (x + y)}}{2i}                                                                                      &  & \by{4.6.6}     \\
     & = \sin(x + y)                                                                                                                      &  & \by{4.7.1}
  \end{align*}
  and
  \begin{align*}
     & \cos(x) \cos(y) - \sin(x) \sin(y)                                                                                                                     \\
     & = \dfrac{e^{i x} + e^{- i x}}{2} \dfrac{e^{i y} + e^{- i y}}{2} - \dfrac{e^{i x} - e^{- i x}}{2i} \dfrac{e^{i y} - e^{- i y}}{2i} &  & \by{4.7.1}     \\
     & = \dfrac{e^{i x} e^{i y} + e^{i x} e^{- i y} + e^{- i x} e^{i y} + e^{- i x} e^{- i y}}{4}                                        &  & \by{4.6.6}     \\
     & \quad + \dfrac{e^{i x} e^{i y} - e^{i x} e^{- i y} - e^{- i x} e^{i y} + e^{- i x} e^{- i y}}{4}                                                      \\
     & = \dfrac{2 e^{i x} e^{i y} + 2 e^{- i x} e^{- i y}}{4}                                                                            &  & \by{4.6.4}     \\
     & = \dfrac{e^{i x} e^{i y} + e^{- i x} e^{- i y}}{2}                                                                                &  & \by{4.6.12}    \\
     & = \dfrac{e^{i x + i y} + e^{- i x - i y}}{2}                                                                                      &  & \by{ex:4.6.16} \\
     & = \dfrac{e^{i (x + y)} + e^{- i (x + y)}}{2}                                                                                      &  & \by{4.6.6}     \\
     & = \cos(x + y).                                                                                                                    &  & \by{4.7.1}
  \end{align*}
\end{proof}

\begin{proof}{(e)}
  We have
  \begin{align*}
             & \sin(-0) = -\sin(0) &  & \text{(by \cref{4.7.2}(c))} \\
    \implies & 2 \sin(0) = 0                                        \\
    \implies & \sin(0) = 0
  \end{align*}
  and
  \begin{align*}
    \cos(0) & = \dfrac{e^{i 0} + e^{- i 0}}{2} &  & \by{4.7.1}                  \\
            & = \dfrac{e^{0} + e^{0}}{2}       &  & \by{4.6.5}                  \\
            & = e^0 = 1.                       &  & \text{(by \cref{4.5.2}(e))}
  \end{align*}
\end{proof}

\begin{proof}{(f)}
  Let \(x \in \R\).
  Then we have
  \begin{align*}
     & \cos(x) + i \sin(x)                                                                   \\
     & = \dfrac{e^{i x} + e^{- i x}}{2} + i \dfrac{e^{i x} - e^{- i x}}{2i} &  & \by{4.7.1}  \\
     & = \dfrac{e^{i x} + e^{- i x}}{2} + \dfrac{e^{i x} - e^{- i x}}{2}    &  & \by{4.6.12} \\
     & = e^{i x}                                                            &  & \by{4.6.4}
  \end{align*}
  and
  \begin{align*}
     & \cos(x) - i \sin(x)                                                                   \\
     & = \dfrac{e^{i x} + e^{- i x}}{2} - i \dfrac{e^{i x} - e^{- i x}}{2i} &  & \by{4.7.1}  \\
     & = \dfrac{e^{i x} + e^{- i x}}{2} - \dfrac{e^{i x} - e^{- i x}}{2}    &  & \by{4.6.12} \\
     & = e^{- i x}.                                                         &  & \by{4.6.4}
  \end{align*}
  By \cref{4.7.2}(a) we know that \(\sin(x), \cos(x) \in \R\).
  Thus we have
  \[
    \Re(e^{i x}) = \Re\big(\cos(x) + i \sin(x)\big) = \cos(x)
  \]
  and
  \[
    \Im(e^{i x}) = \Im\big(\cos(x) + i \sin(x)\big) = \sin(x).
  \]
\end{proof}

\begin{lem}\label{4.7.3}
  There exists a positive number \(x\) such that \(\sin(x)\) is equal to \(0\).
\end{lem}

\begin{proof}
  Suppose for sake of contradiction that \(\sin(x) \neq 0\) for all \(x \in (0, \infty)\).
  Observe that this would also imply that \(\cos(x) \neq 0\) for all \(x \in (0, \infty)\), since if \(\cos(x) = 0\) then \(\sin(2x) = 0\) by \cref{4.7.2}(d).
  Since \(\cos(0) = 1\), this implies by the intermediate value theorem (Theorem 9.7.1 in Analysis I) that \(\cos(x) > 0\) for all \(x > 0\)
  (since by \cref{ac:4.7.1} we know that \(\cos\) is continuous on \(\R\) and by \cref{4.7.2}(a) this means \(\cos(x) \in (0, 1]\)).
  Also, since \(\sin(0) = 0\) and \(\sin'(0) = 1 > 0\), we see that \(\sin\) is increasing near \(0\), hence is positive to the right of \(0\).
  By the intermediate value theorem again we conclude that \(\sin(x) > 0\) for all \(x > 0\)
  (otherwise \(\sin\) would have a zero on \((0, +\infty)\)).

  In particular if we define the cotangent function \(\cot(x) \coloneqq \cos(x) / \sin(x)\), then \(\cot(x)\) would be positive and differentiable on all of \((0, +\infty)\).
  From the quotient rule (Theorem 10.1.13(h) in Analysis I) and \cref{4.7.2} we see that the derivative of \(\cot(x)\) is
  \begin{align*}
    \cot'(x) & = \dfrac{\cos'(x) \sin(x) - \cos(x) \sin'(x)}{\big(\sin(x)\big)^2}                                         \\
             & = \dfrac{-\big(\sin(x)\big)^2 - \big(\cos(x)\big)^2}{\big(\sin(x)\big)^2} &  & \text{(by \cref{4.7.2}(b))} \\
             & = \dfrac{-1}{\big(\sin(x)\big)^2}.                                        &  & \text{(by \cref{4.7.2}(a))}
  \end{align*}
  In particular, we have \(\cot'(x) \leq -1\) for all \(x > 0\).
  By the fundamental theorem of calculus (Theorem 11.9.1 in Analysis I) this implies that
  \begin{align*}
             & \int_x^{x + s} \cot'(t) \; dt \leq \int_x^{x + s} -1 \; dt \\
    \implies & \cot(x + s) - \cot(x) \leq -s                              \\
    \implies & \cot(x + s) \leq \cot(x) - s
  \end{align*}
  for all \(x > 0\) and \(s > 0\).
  Now fix one \(x > 0\) and let \(s = \cot(x)\).
  Since \(s > 0\), we know that \(x + s + 1 > 0\), and thus \(\cot(x + s + 1) > 0\).
  But
  \[
    \cot(x + s + 1) \leq \cot(x) - (s + 1) = \cot(x) - \cot(x) - 1 < 0,
  \]
  a contradiction.
  Thus by letting \(s \to \infty\) we see that this contradicts our assertion that \(\cot\) is positive on \((0, \infty)\).
\end{proof}

\begin{defn}\label{4.7.4}
  We define \(\pi\) to be the number
  \[
    \pi \coloneqq \inf\set{x \in (0, +\infty) : \sin(x) = 0}.
  \]
\end{defn}

\begin{ac}\label{ac:4.7.2}
  The following statements are true.
  \begin{enumerate}
    \item \(\pi\) is well-defined.
    \item \(\pi > 0\).
    \item \(\sin(\pi) = 0\).
    \item \(\sin(x) > 0\) for all \(x \in (0, \pi)\).
    \item \(\cos\) is strictly decreasing on \((0, \pi)\).
    \item \(\cos(\pi) = -1\).
    \item \(e^{\pi i} = \cos(\pi) + i \sin(\pi) = -1\).
  \end{enumerate}
\end{ac}

\begin{proof}
  Let \(E\) be the set \(E \coloneqq \set{x \in (0, +\infty) : \sin(x) = 0}\), i.e., \(E\) is the set of roots of \(\sin\) on \((0, +\infty)\).
  By \cref{4.7.3}, \(E\) is non-empty.
  Since \(\sin'(0) > 0\), there exists a \(c > 0\) such that \(E \subseteq [c, +\infty)\) (see \cref{ex:4.7.2}).
  Also, since \(\sin\) is continuous in \([c, +\infty)\), \(E\) is closed in \([c, +\infty)\)
  (since \(\sin(E) = \set{0} = [0, 0]\) is closed in \((\R, d_{l^1}|_{\R \times \R})\), by \cref{2.1.5}(d) we know that \(E = \sin^{-1}(\set{0})\) is closed in \((\R, d_{l^1}|_{\R \times \R})\)).
  Since \([c, +\infty)\) is closed in \(\R\), we conclude that \(E\) is closed in \(\R\).
  Thus \(E\) contains all its adherent points, and thus contains \(\inf(E) = \pi\) (see Definition 9.1.8 and 9.1.10 in Analysis I).

  We have \(\pi \in E \subseteq [c, +\infty)\) (so in particular \(\pi > 0\)) and \(\sin(\pi) = 0\).
  By \cref{4.7.4}, \(\sin\) cannot have any zeroes in \((0, \pi)\), and so in particular must be positive on \((0, \pi)\)
  (cf. the arguments in \cref{4.7.3} using the intermediate value theorem).
  Since \(\cos'(x) = -\sin(x)\), we thus conclude that \(\cos(x)\) is strictly decreasing on \((0, \pi)\).
  Since \(\cos(0) = 1\), this implies in particular that \(\cos(\pi) < 1\);
  since \(\big(\sin(\pi)\big)^2 + \big(\cos(\pi)\big)^2 = 1\) and \(\sin(\pi) = 0\), we thus conclude that \(\cos(\pi) = -1\).
  Thus we conclude by \cref{4.7.2}(f) that \(e^{i \pi} = \cos(\pi) + i \sin(\pi) = -1\).
\end{proof}

\begin{thm}iodicity of trigonometric functions]\label{4.7.5}
  Let \(x\) be a real number.
  \begin{enumerate}
    \item We have \(\cos(x + \pi) = -\cos(x)\) and \(\sin(x + \pi) = -\sin(x)\).
          In particular we have \(\cos(x + 2\pi) = \cos(x)\) and \(\sin(x + 2\pi) = \sin(x)\), i.e., \(\sin\) and \(\cos\) are periodic with period \(2\pi\).
    \item We have \(\sin(x) = 0\) iff \(x / \pi\) is an integer.
    \item We have \(\cos(x) = 0\) iff \(x / \pi\) is an integer plus \(1 / 2\).
  \end{enumerate}
\end{thm}

\begin{proof}{(a)}
  We have
  \begin{align*}
    \cos(x + \pi) & = \cos(x) \cos(\pi) - \sin(x) \sin(\pi) &  & \text{(by \cref{4.7.2}(d))}       \\
                  & = \cos(x) (-1) - \sin(x) 0              &  & \text{(by \cref{ac:4.7.2}(b)(f))} \\
                  & = -\cos(x)
  \end{align*}
  and
  \begin{align*}
    \sin(x + \pi) & = \sin(x) \cos(\pi) + \cos(x) \sin(\pi) &  & \text{(by \cref{4.7.2}(d))}       \\
                  & = \sin(x) (-1) - \cos(x) 0              &  & \text{(by \cref{ac:4.7.2}(b)(f))} \\
                  & = -\sin(x).
  \end{align*}
  Thus
  \begin{align*}
    \cos(x + 2\pi) & = \cos(x + \pi + \pi)                                    \\
                   & = -\cos(x + \pi)      &  & \text{(from the proof above)} \\
                   & = -\big(-\cos(x)\big) &  & \text{(from the proof above)} \\
                   & = \cos(x)
  \end{align*}
  and
  \begin{align*}
    \sin(x + 2\pi) & = \sin(x + \pi + \pi)                                    \\
                   & = -\sin(x + \pi)      &  & \text{(from the proof above)} \\
                   & = -\big(-\sin(x)\big) &  & \text{(from the proof above)} \\
                   & = \sin(x).
  \end{align*}
\end{proof}

\begin{proof}{(b)}
  First we show that \(\dfrac{x}{\pi} \in \Z\) implies \(\sin(x) = 0\).
  Let \(P(n)\) be the statement ``\(n = \dfrac{x}{\pi}\) implies \(\sin(x) = 0\)''.
  We use induction to show that \(P(n)\) is true for all \(n \in \N\).
  For \(n = 0\), we have
  \begin{align*}
             & 0 = \dfrac{x}{\pi}                                      \\
    \implies & x = 0                                                   \\
    \implies & \sin(x) = \sin(0) = 0. &  & \text{(by \cref{4.7.2}(e))}
  \end{align*}
  Thus the base holds.
  Suppose inductively that \(P(n)\) is true for some \(n \geq 0\).
  Then for \(n + 1\), we have
  \begin{align*}
             & n + 1 = \dfrac{x}{\pi}                                                      \\
    \implies & x = n \pi + \pi                                                             \\
    \implies & \sin(x) = \sin(n \pi + \pi) = -\sin(n \pi) &  & \text{(by \cref{4.7.4}(a))} \\
    \implies & \sin(x) = -\sin(n \pi) = 0.                &  & \byIH
  \end{align*}
  This closes the induction.
  Thus \(P(n)\) is true for all \(n \in \N\).
  Since
  \begin{align*}
             & \forall n \in \Z^-, n = \dfrac{x}{\pi}                                    \\
    \implies & -n = -\dfrac{x}{\pi} \in \Z^+                                             \\
    \implies & \sin(-x) = \sin(- n \pi) = 0           &  & \text{(from the proof above)} \\
    \implies & -\sin(x) = 0                           &  & \text{(by \cref{4.7.2}(c))}   \\
    \implies & \sin(x) = 0,
  \end{align*}
  we know that \(P(n)\) is true for all \(n \in \Z\).

  Now we show that \(\sin(x) = 0\) implies \(\dfrac{x}{\pi}\) is an integer.
  Let \(x \in \R\).
  Suppose that \(\sin(x) = 0\).
  Now we split into three cases:
  \begin{itemize}
    \item \(x = 0\).
          By \cref{ac:4.7.2}(b) we know that \(\pi > 0\), thus we know that \(\dfrac{0}{\pi} = 0 \in \N\) and by \cref{4.7.2}(e) we have \(\sin(0) = 0\).
    \item \(x \in \R^+\).
          Since \(\pi > 0\), by Archimedean property we know that
          \begin{align*}
                     & \exists n \in \N : n \pi \leq x < (n + 1) \pi \\
            \implies & \exists n \in \N : 0 \leq x - n \pi < \pi.
          \end{align*}
          Fix such \(n\).
          By \cref{ac:4.7.2}(d) we know that \(\sin(y) > 0\) for all \(y \in (0, \pi)\).
          Thus we must have \(x - n \pi = 0\).
          This means \(\dfrac{x}{\pi} = n \in \N\).
    \item \(x \in \R^-\).
          Then we have
          \begin{align*}
                     & \sin(x) = 0                                                \\
            \implies & -\big(-\sin(x)\big) = 0                                    \\
            \implies & -\sin(-x) = 0           &  & \text{(by \cref{4.7.2}(e))}   \\
            \implies & \sin(-x) = 0                                               \\
            \implies & \dfrac{-x}{\pi} \in \N  &  & \text{(from the proof above)} \\
            \implies & \dfrac{x}{\pi} \in \Z.
          \end{align*}
  \end{itemize}
  From all cases above we conclude that
  \[
    \sin(x) = 0 \implies \dfrac{x}{\pi} \in \Z.
  \]
\end{proof}

\begin{proof}{(c)}
  By \cref{ac:4.7.2}(d) we know that \(\sin(\dfrac{\pi}{2}) > 0\).
  Since
  \begin{align*}
    0 & = \sin(\pi)                                                                             &  & \text{(by \cref{ac:4.7.2}(c))} \\
      & = \sin(\dfrac{\pi}{2} + \dfrac{\pi}{2})                                                                                     \\
      & = \sin(\dfrac{\pi}{2}) \cos(\dfrac{\pi}{2}) + \cos(\dfrac{\pi}{2}) \sin(\dfrac{\pi}{2}) &  & \text{(by \cref{4.7.2}(d))}    \\
      & = 2 \sin(\dfrac{\pi}{2}) \cos(\dfrac{\pi}{2}),
  \end{align*}
  we know that \(\cos(\dfrac{\pi}{2}) = 0\).
  Since
  \begin{align*}
             & \big(\sin(\dfrac{\pi}{2})\big)^2 + \big(\cos(\dfrac{\pi}{2})\big)^2 = 1 &  & \text{(by \cref{4.7.2}(a))}    \\
    \implies & \big(\sin(\dfrac{\pi}{2})\big)^2 = 1                                    &  & \text{(from the proof above)}  \\
    \implies & \sin(\dfrac{\pi}{2}) = 1,                                               &  & \text{(by \cref{ac:4.7.2}(d))}
  \end{align*}
  We know that
  \begin{align*}
    \forall x \in \R, \cos(x) & = \cos(x + \dfrac{\pi}{2} - \dfrac{\pi}{2})                                                                                          \\
                              & = \cos(x + \dfrac{\pi}{2}) \cos(-\dfrac{\pi}{2}) - \sin(x + \dfrac{\pi}{2}) \sin(-\dfrac{\pi}{2}) &  & \text{(by \cref{4.7.2}(d))}   \\
                              & = \cos(x + \dfrac{\pi}{2}) \cos(\dfrac{\pi}{2}) + \sin(x + \dfrac{\pi}{2}) \sin(\dfrac{\pi}{2})   &  & \text{(by \cref{4.7.2}(c))}   \\
                              & = \cos(x + \dfrac{\pi}{2}) \times 0 + \sin(x + \dfrac{\pi}{2}) \times 1                           &  & \text{(from the proof above)} \\
                              & = \sin(x + \dfrac{\pi}{2}).
  \end{align*}
  Thus we have
  \begin{align*}
         & \forall x \in \R, \bigg(\sin(x + \dfrac{\pi}{2}) = 0 \iff \dfrac{x + \dfrac{\pi}{2}}{\pi} \in \Z\bigg)  &  & \text{(by \cref{4.7.5}(b))}   \\
    \iff & \forall x \in \R, \bigg(\sin(x + \dfrac{\pi}{2}) = 0 \iff \dfrac{x}{\pi} + \dfrac{1}{2} \in \Z\bigg)                                       \\
    \iff & \forall x \in \R, \bigg(\cos(x) = 0 \iff \dfrac{x}{\pi} + \dfrac{1}{2} \in \Z\bigg)                     &  & \text{(from the proof above)} \\
    \iff & \forall x \in \R, \bigg(\cos(x) = 0 \iff \exists n \in \Z : n = \dfrac{x}{\pi} + \dfrac{1}{2}\bigg)                                        \\
    \iff & \forall x \in \R, \bigg(\cos(x) = 0 \iff \exists n \in \Z : n + 1 = \dfrac{x}{\pi} + \dfrac{1}{2}\bigg)                                    \\
    \iff & \forall x \in \R, \bigg(\cos(x) = 0 \iff \exists n \in \Z : n + \dfrac{1}{2} = \dfrac{x}{\pi}\bigg).
  \end{align*}
\end{proof}

\exercisesection

\begin{ex}\label{ex:4.7.1}
  Prove \cref{4.7.2}.
\end{ex}

\begin{proof}
  See \cref{4.7.2}.
\end{proof}

\begin{ex}\label{ex:4.7.2}
  Let \(f : \R \to \R\) be a function which is differentiable at \(x_0\), with \(f(x_0) = 0\) and \(f'(x_0) \neq 0\).
  Show that there exists a \(c > 0\) such that \(f(y)\) is non-zero whenever \(0 < \abs{x_0 - y} < c\).
  Conclude in particular that there exists a \(c > 0\) such that \(\sin(x) \neq 0\) for all \(0 < x < c\).
\end{ex}

\begin{proof}
  Since
  \begin{align*}
             & f'(x_0) \neq 0                                                                                                                                                                                \\
    \implies & \lim_{y \to x_0 ; y \in \R \setminus \set{x_0}} \dfrac{f(y) - f(x_0)}{y - x_0} = \lim_{y \to x_0 ; y \in \R \setminus \set{x_0}} \dfrac{f(y)}{y - x_0} \neq 0                                 \\
    \implies & \forall \varepsilon \in \R^+, \exists \delta \in \R^+ : \forall y \in \R \setminus \set{x_0}, \bigg(\abs{y - x_0} < \delta \implies \abs{\dfrac{f(y)}{y - x_0} - f'(x_0)} < \varepsilon\bigg) \\
    \implies & \forall \varepsilon \in \R^+, \exists \delta \in \R^+ : \forall y \in \R, \bigg(0 < \abs{y - x_0} < \delta \implies \abs{\dfrac{f(y)}{y - x_0} - f'(x_0)} < \varepsilon\bigg)                 \\
    \implies & \exists \delta \in \R^+ : \forall y \in \R, \bigg(0 < \abs{y - x_0} < \delta \implies \abs{\dfrac{f(y)}{y - x_0} - f'(x_0)} < \dfrac{\abs{f'(x_0)}}{2}\bigg)                                  \\
    \implies & \exists \delta \in \R^+ : \forall y \in \R,                                                                                                                                                   \\
             & \bigg(0 < \abs{y - x_0} < \delta \implies f'(x_0) - \dfrac{\abs{f'(x_0)}}{2} < \dfrac{f(y)}{y - x_0} < f'(x_0) + \dfrac{\abs{f'(x_0)}}{2}\bigg),
  \end{align*}
  by setting \(c = \delta\) we know that
  \begin{align*}
             & 0 < \abs{x - x_0} < c                                                                                               \\
    \implies & \begin{dcases}
                 \dfrac{3 f'(x_0)}{2} < \dfrac{f(y)}{y - x_0} < \dfrac{f'(x_0)}{2} < 0 & \text{if} f'(x_0) < 0 \\
                 0 < \dfrac{f'(x_0)}{2} < \dfrac{f(y)}{y - x_0} < \dfrac{3 f'(x_0)}{2} & \text{if} f'(x_0) > 0
               \end{dcases}                       \\
    \implies & f(y) \neq 0.                                                                                     & (y - x_0 \neq 0)
  \end{align*}

  By \cref{4.7.2}(b)(e) we know that \(\sin'(0) = \cos(0) = 1\), thus we conclude that
  \[
    \exists c \in \R^+ : \forall x \in (0, c), \sin(x) \neq 0.
  \]
\end{proof}

\begin{ex}\label{ex:4.7.3}
  Prove \cref{4.7.5}.
\end{ex}

\begin{proof}
  See \cref{4.7.5}.
\end{proof}

\begin{ex}\label{ex:4.7.4}
  Let \(x, y\) be real numbers such that \(x^2 + y^2 = 1\).
  Show that there is exactly one real number \(\theta \in (-\pi, \pi]\) such that \(x = \sin(\theta)\) and \(y = \cos(\theta)\).
\end{ex}

\begin{proof}
  Observe that
  \begin{align*}
             & x^2 + y^2 = 1     \\
    \implies & x, y \in [-1, 1].
  \end{align*}
  We split into three cases:
  \begin{itemize}
    \item \(x = 0\).
          Then we know that \(y = \pm 1\).
          Since
          \begin{align*}
                     & \theta \in (-\pi, \pi]                                                                              \\
            \implies & \dfrac{\theta}{\pi} \in (-1, 1]                                                                     \\
            \implies & \bigg(\sin(\theta) = 0 \iff \dfrac{\theta}{\pi} = \set{0, 1}\bigg) &  & \text{(by \cref{4.7.5}(b))} \\
            \implies & \bigg(\sin(\theta) = 0 \iff \theta = \set{0, \pi}\bigg)
          \end{align*}
          and
          \begin{align*}
             & \cos(0) = 1;    &  & \text{(by \cref{4.7.2}(e))}    \\
             & \cos(\pi) = -1, &  & \text{(by \cref{ac:4.7.2}(f))}
          \end{align*}
          we know that
          \begin{align*}
             & (x, y) = (0, 1) = \big(\sin(0), \cos(0)\big) \iff \theta = 0;        \\
             & (x, y) = (0, -1) = \big(\sin(\pi), \cos(\pi)\big) \iff \theta = \pi.
          \end{align*}
    \item \(x \in (0, 1]\).
          Then we have
          \[
            x^2 + y^2 = 1 \implies y = \pm \sqrt{1 - x^2} \in (-1, 1).
          \]
          Since
          \begin{align*}
                     & z \in (0, \pi)                                     \\
            \implies & \sin(z) > 0    &  & \text{(by \cref{ac:4.7.2}(d))} \\
            \implies & -\sin(z) < 0                                       \\
            \implies & \sin(-z) < 0,  &  & \text{(by \cref{4.7.2}(c))}
          \end{align*}
          we know that
          \[
            \forall z \in (-\pi, 0), \sin(z) < 0.
          \]
          Thus
          \begin{align*}
                     & \sin(\theta) = x > 0 \\
            \implies & \theta \in (0, \pi).
          \end{align*}
          Since \(\sin(\dfrac{\pi}{2}) = 1\) (cf. the proof of \cref{4.7.5}(c)) and \(\sin\) is continuous on \(\R\) (by \cref{ac:4.7.1}), by intermediate value theorem we know that
          \begin{align*}
             & \exists \theta_1 \in (0, \dfrac{\pi}{2}] : \sin(\theta_1) = x   & \text{since } \sin\big((0, \dfrac{\pi}{2}]\big) \subseteq (0, 1]   \\
             & \exists \theta_2 \in [\dfrac{\pi}{2}, \pi) : \sin(\theta_2) = x & \text{since } \sin\big([\dfrac{\pi}{2}, \pi)\big) \subseteq (0, 1]
          \end{align*}
          Since \(\cos(0) = 1\) (by \cref{4.7.2}(e)) and \(\cos(\dfrac{\pi}{2}) = 0\) (cf. the proof of \cref{4.7.5}(c)), we know that
          \begin{align*}
                     & \cos \text{ is strictly decreasing on } (0, \pi)    &  & \text{(by \cref{ac:4.7.2}(e))} \\
            \implies & \cos\big((0, \dfrac{\pi}{2}]\big) \subseteq [0, 1).
          \end{align*}
          Using similar arguments we can show that \(\cos\big([\dfrac{\pi}{2}, \pi)\big) \subseteq (-1, 0]\).
          Thus we have
          \begin{align*}
             & \big(x \in (0, 1]\big) \land \big(y \in [0, 1)\big) \implies \exists \theta_1 \in (0, \dfrac{\pi}{2}] : \big(\sin(\theta_1) = x\big) \land \big(\cos(\theta_1) = y\big);    \\
             & \big(x \in (0, 1]\big) \land \big(y \in (-1, 0]\big) \implies \exists \theta_2 \in [\dfrac{\pi}{2}, \pi) : \big(\sin(\theta_2) = x\big) \land \big(\cos(\theta_2) = y\big).
          \end{align*}
          But \(\cos\) is strictly decreasing on \((0, \pi)\) implies the choices of \(\theta_1\) and \(\theta_2\) are unique.
          And we conclude that
          \[
            \forall x \in (0, 1], \exists!\ \theta \in (0, \pi) : \begin{dcases}
              \sin(\theta) = x \\
              \cos(\theta) = y \\
              x^2 + y^2 = 1
            \end{dcases}
          \]
    \item \(x \in [-1, 0)\).
          Then we have
          \begin{align*}
                     & -x \in (0, 1]                                                                    \\
            \implies & \exists!\ \theta \in (0, \pi) : \begin{dcases}
                                                         \sin(\theta) = -x \\
                                                         \cos(\theta) = y  \\
                                                         (-x)^2 + y^2 = x^2 + y^2 = 1
                                                       \end{dcases}  &  & \text{(from the proof above)} \\
            \implies & \exists!\ \theta \in (0, \pi) : \begin{dcases}
                                                         \sin(-\theta) = -\sin(\theta) = x \\
                                                         \cos(-\theta) = \cos(\theta) = y  \\
                                                         x^2 + y^2 = 1
                                                       \end{dcases}  &  & \text{(by \cref{4.7.2}(c))}   \\
            \implies & \exists!\ \theta \in (-\pi, 0) : \begin{dcases}
                                                          \sin(\theta) = x \\
                                                          \cos(\theta) = y \\
                                                          x^2 + y^2 = 1
                                                        \end{dcases}
          \end{align*}
  \end{itemize}
  From all cases above we conclude that
  \[
    \exists!\ \theta \in (-\pi, \pi] : \begin{dcases}
      \sin(\theta) = x \\
      \cos(\theta) = y \\
      x^2 + y^2 = 1
    \end{dcases}
  \]
\end{proof}

\begin{ex}\label{ex:4.7.5}
  Show that if \(r, s > 0\) are positive real numbers, and \(\theta, \alpha\) are real numbers such that \(r e^{i \theta} = s e^{i \alpha}\), then \(r = s\) and \(\theta = \alpha + 2 \pi k\) for some integer \(k\).
\end{ex}

\begin{proof}
  By \cref{ac:4.7.2}(g) we know that
  \begin{align*}
    r e^{i \theta} & = r \big(\cos(\theta) + i \sin(\theta)\big); \\
    s e^{i \alpha} & = s \big(\cos(\alpha) + i \sin(\alpha)\big).
  \end{align*}
  Since
  \begin{align*}
             & r e^{i \theta} = s e^{i \alpha}                                                       \\
    \implies & r \big(\cos(\theta) + i \sin(\theta)\big) = s \big(\cos(\alpha) + i \sin(\alpha)\big) \\
    \implies & r \cos(\theta) - s \cos(\alpha) + i \big(r \sin(\theta) - s \sin(\alpha)\big) = 0     \\
    \implies & \begin{dcases}
                 r \cos(\theta) - s \cos(\alpha) = 0 \\
                 r \sin(\theta) - s \sin(\alpha) = 0
               \end{dcases}                                                   \\
    \implies & \begin{dcases}
                 r \cos(\theta) = s \cos(\alpha) \\
                 r \sin(\theta) = s \sin(\alpha)
               \end{dcases}
  \end{align*}
  we know that
  \begin{align*}
             & (r \sin(\theta))^2 + (r \cos(\theta))^2 = (s \sin(\alpha))^2 + (s \cos(\alpha))^2                                                                                                     \\
    \implies & r^2 \Big(\big(\sin(\theta)\big)^2 + \big(\cos(\theta)\big)^2\Big) = s^2 \Big(\big(\sin(\alpha)\big)^2 + \big(\cos(\alpha)\big)^2\Big)                                                 \\
    \implies & r^2 = s^2                                                                                                                             &                 & \text{(by \cref{4.7.2}(a))} \\
    \implies & r = s.                                                                                                                                & (r, s \in \R^+)
  \end{align*}
  Thus we have
  \begin{align*}
             & \begin{dcases}
                 r \cos(\theta) = s \cos(\alpha) \\
                 r \sin(\theta) = s \sin(\alpha)
               \end{dcases}     \\
    \implies & \begin{dcases}
                 \cos(\theta) = \cos(\alpha) \\
                 \sin(\theta) = \sin(\alpha)
               \end{dcases}     & (r = s \in \R^+)
  \end{align*}
  and
  \begin{align*}
    \sin(\theta - \alpha) & = \sin(\theta) \cos(-\alpha) + \cos(\theta) \sin(-\alpha) &  & \text{(by \cref{4.7.2}(d))}   \\
                          & = \sin(\theta) \cos(\alpha) - \cos(\theta) \sin(\alpha)   &  & \text{(by \cref{4.7.2}(c))}   \\
                          & = \sin(\alpha) \cos(\alpha) - \cos(\alpha) \sin(\alpha)   &  & \text{(from the proof above)} \\
                          & = 0.
  \end{align*}
  By \cref{4.7.5}(b) we know that
  \begin{align*}
         & \sin(\theta - \alpha) = 0                           \\
    \iff & \dfrac{\theta - \alpha}{\pi} \in \Z                 \\
    \iff & \exists k \in \Z : k = \dfrac{\theta - \alpha}{\pi} \\
    \iff & \exists k \in \Z : k \pi = \theta - \alpha          \\
    \iff & \exists k \in \Z : \theta = \alpha + k \pi.
  \end{align*}
  By \cref{4.7.5} we know that for any \(\alpha \in \R\), \(\cos(\alpha + k \pi) = \cos(\alpha)\) when \(k\) is even.
  So we only need to show that for any \(\alpha \in \R\), \(\cos(\alpha + k \pi) \neq \cos(\alpha)\) when \(k\) is odd.
  Suppose for sake of contradiction that for any \(\alpha \in \R\), \(\cos(\alpha + k \pi) = \cos(\alpha)\) when \(k\) is odd.
  Let \(k = 2n + 1\) for some \(n \in \Z\).
  Then we have
  \begin{align*}
    \cos(\theta) & = \cos(\alpha + k \pi)                                                   \\
                 & = \cos\big(\alpha + (2n + 1) \pi\big)                                    \\
                 & = \cos(\alpha + 2 n \pi + \pi)                                           \\
                 & = -\cos(\alpha + 2 n \pi)             &  & \text{(by \cref{4.7.5}(a))}   \\
                 & = -\cos(\alpha)                       &  & \text{(by \cref{4.7.5}(a))}   \\
                 & = -\cos(\theta).                      &  & \text{(from the proof above)}
  \end{align*}
  This means \(\cos(\theta) = 0\).
  But by \cref{4.7.5}(c) we know that
  \begin{align*}
             & \exists m \in \Z : m + \dfrac{1}{2} = \dfrac{\theta}{\pi} = \dfrac{\alpha}{\pi} + k \\
    \implies & \exists m \in \Z : m - k + \dfrac{1}{2} = \dfrac{\alpha}{\pi} \notin \Z.
  \end{align*}
  Thus when \(\alpha = \pi\) we derive contradiction.
  We conclude that
  \[
    \forall k \in \Z, \theta = \alpha + 2 k \pi.
  \]
\end{proof}

\begin{ex}\label{ex:4.7.6}
  Let \(z\) be a non-zero complex number.
  Using \cref{ex:4.7.4}, show that there is exactly one pair of real numbers \(r, \theta\) such that \(r > 0\), \(\theta \in (-\pi, \pi]\), and \(z = r e^{i \theta}\).
  (This is sometimes known as the \emph{standard polar representation} of \(z\).)
\end{ex}

\begin{proof}
  Observe that
  \begin{align*}
             & z \neq 0                                                                                                                                                                     \\
    \implies & \abs{z} > 0                                                                                                                                 &  & \by{4.6.11}                 \\
    \implies & \dfrac{z}{\abs{z}} \in \C                                                                                                                                                    \\
    \implies & \abs{\dfrac{z}{\abs{z}}} = \dfrac{\abs{z}}{\abs{\abs{z}}} = \dfrac{\abs{z}}{\abs{z}} = 1                                                    &  & \by{ex:4.6.7}               \\
    \implies & \big(\Re(\dfrac{z}{\abs{z}})\big)^2 + \big(\Im(\dfrac{z}{\abs{z}})\big)^2 = 1                                                               &  & \by{4.6.10}                 \\
    \implies & \exists!\ \theta \in (-\pi, \pi] : \begin{dcases}
                                                    \cos(\theta) = \Re(\dfrac{z}{\abs{z}}) \\
                                                    \sin(\theta) = \Im(\dfrac{z}{\abs{z}})
                                                  \end{dcases}                                                                    &  & \by{ex:4.7.4}                                        \\
    \implies & \exists!\ \theta \in (-\pi, \pi] : \dfrac{z}{\abs{z}} = \Re(\dfrac{z}{\abs{z}}) + i \Im(\dfrac{z}{\abs{z}}) = \cos(\theta) + i \sin(\theta) &  & \by{4.6.8}                  \\
    \implies & \exists!\ \theta \in (-\pi, \pi] : \dfrac{z}{\abs{z}} = e^{i \theta}                                                                        &  & \text{(by \cref{4.7.2}(f))} \\
    \implies & \exists!\ \theta \in (-\pi, \pi] : z = \abs{z} e^{i \theta}.                                                                                &  & \text{(by \cref{4.7.2}(f))}
  \end{align*}
  By setting \(r = \abs{z}\) we are done.
\end{proof}

\begin{ex}\label{ex:4.7.7}
  For any real number \(\theta\) and integer \(n\), prove the \emph{de Moivre identities}
  \[
    \cos(n \theta) = \Re\Big(\big(\cos(\theta) + i \sin(\theta)\big)^n\Big); \quad \sin(n \theta) = \Im\Big(\big(\cos(\theta) + i \sin(\theta)\big)^n\Big).
  \]
\end{ex}

\begin{proof}
  By \cref{4.7.2}(a) we know that \(\big(\cos(\theta)\big)^2 + \big(\sin(\theta)\big)^2 = 1\), thus we cannot have \(\cos(\theta) = 0\) and \(\sin(\theta) = 0\) at the same time.
  By \cref{4.6.12} this means \(\big(\cos(\theta) + i \sin(\theta)\big)^{-1}\) is well-defined and
  \[
    \big(\cos(\theta) + i \sin(\theta)\big)^0 = \big(\cos(\theta) + i \sin(\theta)\big) \big(\cos(\theta) + i \sin(\theta)\big)^{-1} = 1.
  \]
  First suppose that \(n = 0\).
  Then we have
  \begin{align*}
    \cos(0 \theta) & = \cos(0)                                                                                 \\
                   & = 1                                                      &  & \text{(by \cref{4.7.2}(e))} \\
                   & = \Re(1)                                                 &  & \by{4.6.8}                  \\
                   & = \Re\Big(\big(\cos(\theta) + i \sin(\theta)\big)^0\Big) &  & \by{4.6.12}
  \end{align*}
  and
  \begin{align*}
    \sin(0 \theta) & = \sin(0)                                                                                 \\
                   & = 0                                                      &  & \text{(by \cref{4.7.2}(e))} \\
                   & = \Im(1)                                                 &  & \by{4.6.8}                  \\
                   & = \Im\Big(\big(\cos(\theta) + i \sin(\theta)\big)^0\Big) &  & \by{4.6.12}
  \end{align*}

  Next suppose that \(n \in \Z^+\).
  Since
  \begin{align*}
    \big(\cos(\theta) + i \sin(\theta)\big)^n & = (e^{i \theta})^n &  & \text{(by \cref{4.7.2}(f))} \\
                                              & = e^{n i \theta}   &  & \by{ex:4.6.16}              \\
                                              & = e^{i n \theta},  &  & \by{4.6.6}
  \end{align*}
  we know that
  \begin{align*}
    \cos(n \theta) & = \Re(e^{i n \theta})                                    &  & \text{(by \cref{4.7.2}(f))}   \\
                   & = \Re\Big(\big(\cos(\theta) + i \sin(\theta)\big)^n\Big) &  & \text{(from the proof above)}
  \end{align*}
  and
  \begin{align*}
    \sin(n \theta) & = \Im(e^{i n \theta})                                     &  & \text{(by \cref{4.7.2}(f))}   \\
                   & = \Im\Big(\big(\cos(\theta) + i \sin(\theta)\big)^n\Big). &  & \text{(from the proof above)}
  \end{align*}

  Finally suppose that \(n \in \Z^-\).
  Let \(k \in \Z^+\) such that \(-k = n\).
  Since
  \begin{align*}
     & \big(\cos(\theta) + i \sin(\theta)\big)^{-1}                                                                                                        \\
     & = \abs{\cos(\theta) + i \sin(\theta)}^{-2} \big(\overline{\cos(\theta) + i \sin(\theta)}\big)                      &  & \by{4.6.12}                 \\
     & = \Big(\big(\cos(\theta)\big)^2 + \big(\sin(\theta)\big)^2\Big) \big(\overline{\cos(\theta) + i \sin(\theta)}\big) &  & \by{4.6.10}                 \\
     & = \overline{\cos(\theta) + i \sin(\theta)}                                                                         &  & \text{(by \cref{4.7.2}(a))} \\
     & = \cos(\theta) - i \sin(\theta)                                                                                                                     \\
     & = e^{- i \theta},                                                                                                  &  & \text{(by \cref{4.7.2}(f))}
  \end{align*}
  we know that
  \begin{align*}
     & \big(\cos(\theta) + i \sin(\theta)\big)^n                                                     \\
     & = \big(\cos(\theta) + i \sin(\theta)\big)^{-k}                                                \\
     & = \Big(\big(\cos(\theta) + i \sin(\theta)\big)^{-1}\Big)^k &  & \by{4.6.12}                   \\
     & = (e^{- i \theta})^k                                       &  & \text{(from the proof above)} \\
     & = e^{k (- i \theta)}                                       &  & \by{ex:4.6.16}                \\
     & = e^{- i k \theta}                                         &  & \by{4.6.6}                    \\
     & = \cos(k \theta) - i \sin(k \theta)                        &  & \text{(by \cref{4.7.2}(f))}   \\
     & = \cos(- k \theta) + i \sin(- k \theta)                    &  & \text{(by \cref{4.7.2}(c))}   \\
     & = \cos(n \theta) + i \sin(n \theta).
  \end{align*}
  Thus we have
  \begin{align*}
    \cos(n \theta) & = \Re\big(\cos(n \theta) + i \sin(n \theta)\big)         &  & \by{4.6.8}                    \\
                   & = \Re\Big(\big(\cos(\theta) + i \sin(\theta)\big)^n\Big) &  & \text{(from the proof above)}
  \end{align*}
  and
  \begin{align*}
    \sin(n \theta) & = \Im\big(\cos(n \theta) + i \sin(n \theta)\big)          &  & \by{4.6.8}                    \\
                   & = \Im\Big(\big(\cos(\theta) + i \sin(\theta)\big)^n\Big). &  & \text{(from the proof above)}
  \end{align*}
\end{proof}

\begin{ex}\label{ex:4.7.8}
  Let \(\tan : (- \pi / 2, \pi / 2) \to \R\) be the tangent function \(\tan(x) \coloneqq \sin(x) / \cos(x)\).
  Show that \(\tan\) is differentiable and monotone increasing, with
  \[
    \dfrac{d}{dx} \tan(x) = 1 + \big(\tan(x)\big)^2,
  \]
  and that \(\lim_{x \to \pi / 2} \tan(x) = +\infty\) and \(\lim_{x \to -\pi / 2} \tan(x) = -\infty\).
  Conclude that \(\tan\) is in fact a bijection from \((- \pi / 2, \pi / 2) \to \R\), and thus has an inverse function \(\tan^{-1} : \R \to (- \pi / 2, \pi / 2)\)
  (this function is called the \emph{arctangent function}).
  Show that \(\tan^{-1}\) is differentiable and \(\dfrac{d}{dx} \tan^{-1}(x) = \dfrac{1}{1 + x^2}\).
\end{ex}

\begin{proof}
  By \cref{4.7.5}(c) we know that \(\cos(-\dfrac{\pi}{2}) = \cos(\dfrac{\pi}{2}) = 0\) and \(\cos(x) \neq 0\) for all \(x \in (-\dfrac{\pi}{2}, \dfrac{\pi}{2})\).
  Thus \(\tan(x)\) is well-defined on \((-\dfrac{\pi}{2}, \dfrac{\pi}{2})\).
  By \cref{ac:4.7.1} we know that \(\sin\) and \(\cos\) are differentiable on \(\R\), thus by Theorem 10.1.13(h) in Analysis I we know that \(\tan\) is differentiable on \((-\dfrac{\pi}{2}, \dfrac{\pi}{2})\).
  In particular, for all \(x \in (-\dfrac{\pi}{2}, \dfrac{\pi}{2})\), we have
  \begin{align*}
    \tan'(x) & = \dfrac{\sin'(x) \cos(x) - \sin(x) \cos'(x)}{\big(\cos(x)\big)^2}                                        \\
             & = \dfrac{\big(\cos(x)\big)^2 + \big(\sin(x)\big)^2}{\big(\cos(x)\big)^2} &  & \text{(by \cref{4.7.2}(b))} \\
             & = 1 + \big(\tan(x)\big)^2.
  \end{align*}
  Since \(\tan'(x) > 0\) for all \(x \in (-\dfrac{\pi}{2}, \dfrac{\pi}{2})\), by Proposition 10.3.3 we know that \(\tan\) is strictly monotone increasing on \((-\dfrac{\pi}{2}, \dfrac{\pi}{2})\).

  Since \(\sin(\dfrac{\pi}{2}) = 1\) (cf. the proof of \cref{4.7.5}(c)), by \cref{4.7.2}(b) we know that \(\sin(-\dfrac{\pi}{2}) = -1\).
  Since \(\sin\) and \(\cos\) are continuous on \(\R\), we know that
  \begin{align*}
     & \lim_{x \to \dfrac{\pi}{2}} \sin(x) = \sin(\dfrac{\pi}{2}) = 1    \\
     & \lim_{x \to -\dfrac{\pi}{2}} \sin(x) = \sin(-\dfrac{\pi}{2}) = -1 \\
     & \lim_{x \to \dfrac{\pi}{2}} \cos(x) = \cos(\dfrac{\pi}{2}) = 0    \\
     & \lim_{x \to -\dfrac{\pi}{2}} \cos(x) = \cos(-\dfrac{\pi}{2}) = 0
  \end{align*}
  Since \(\tan\) is monotone increasing on \((-\dfrac{\pi}{2}, \dfrac{\pi}{2})\) and \(\tan(0) = \dfrac{\sin(0)}{\cos(0)} = 0\), we know that \(\tan(x) > 0\) for all \(x \in (0, \dfrac{\pi}{2})\) and \(\tan(x) < 0\) for all \(x \in (-\dfrac{\pi}{2})\).
  Suppose for sake of contradiction that \(\lim_{x \to \dfrac{\pi}{2}} \tan(x) \in \R\).
  Then we have
  \begin{align*}
             & \begin{dcases}
                 \forall x \in (0, \dfrac{\pi}{2}), \tan(x) > 0 \\
                 \tan \text{ is strictly monotone increasing on } (-\dfrac{\pi}{2}, \dfrac{\pi}{2})
               \end{dcases}                                                                                                                                                                                      \\
    \implies & \lim_{x \to \dfrac{\pi}{2}} \tan(x) \in \R^+                                                                                                                                                                                                                           \\
    \implies & \dfrac{\lim_{x \to \dfrac{\pi}{2}} \tan(x)}{\sin(\dfrac{\pi}{2})} = \dfrac{\lim_{x \to \dfrac{\pi}{2}} \tan(x)}{\lim_{x \to \dfrac{\pi}{2}} \sin(x)} = \lim_{x \to \dfrac{\pi}{2}} \dfrac{\tan(x)}{\sin(x)} = \lim_{x \to \dfrac{\pi}{2}} \dfrac{1}{\cos(x)} \in \R^+.
  \end{align*}
  But this contradict to the fact that \(\lim_{x \to \dfrac{\pi}{2}} \dfrac{1}{\cos(x)} = +\infty\).
  Thus we know that
  \[
    \lim_{x \to \dfrac{\pi}{2}} \tan(x) \in \set{-\infty, \infty}.
  \]
  But strictly monotone increasing implies
  \[
    \lim_{x \to \dfrac{\pi}{2}} \tan(x) = +\infty.
  \]
  Using similar arguments we can show that
  \[
    \lim_{x \to -\dfrac{\pi}{2}} \tan(x) = -\infty.
  \]
  This means \(\tan\) is a bijection from \((-\dfrac{\pi}{2}, \dfrac{\pi}{2})\) to \(\R\).
  Thus \(\tan^{-1} : \R \to (-\dfrac{\pi}{2}, \dfrac{\pi}{2})\) is well-defined.

  Since \(\tan'(x) > 0\) for all \(x \in (-\dfrac{\pi}{2}, \dfrac{\pi}{2})\), by inverse function theorem (Theorem 10.4.2 in Analysis I) we have
  \begin{align*}
             & \forall x \in (-\dfrac{\pi}{2}, \dfrac{\pi}{2}), \tan(x) = y                                     \\
    \implies & (\tan^{-1})'(y) = \dfrac{1}{\tan'(x)} = \dfrac{1}{1 + \big(\tan(x)\big)^2} = \dfrac{1}{1 + y^2}.
  \end{align*}
\end{proof}

\begin{ex}\label{ex:4.7.9}
  Recall the arctangent function \(\tan^{-1}\) from \cref{ex:4.7.8}.
  By modifying the proof of \cref{4.5.6}(e), establish the identity
  \[
    \tan^{-1}(x) = \sum_{n = 0}^\infty \dfrac{(-1)^n x^{2n + 1}}{2n + 1}
  \]
  for all \(x \in (-1, 1)\).
  Using Abel's theorem (\cref{4.3.1}) to extend this identity to the case \(x = 1\), conclude in particular the identity
  \[
    \pi = 4 - \dfrac{4}{3} + \dfrac{4}{5} - \dfrac{4}{7} + \dots = 4 \sum_{n = 0}^\infty \dfrac{(-1)^n}{2n + 1}.
  \]
  (Note that the series converges by the alternating series test, Proposition 7.2.12 in Analysis I.)
  Conclude in particular that \(4 - \dfrac{4}{3} < \pi < 4\).
  (One can of course compute \(\pi = 3.1415926 \dots\) to much higher accuracy, though if one wishes to do so it is advisable to use a different formula than the one above, which converges very slowly.)
\end{ex}

\begin{proof}
  By \cref{ex:4.7.9} we know that \(\tan^{-1}(x)\) is well-defined for all \(x \in \R\), in particular \(\tan(x)\) is well-defined for all \(x \in (-1, 1)\).
  First suppose that \(x = 0\).
  By \cref{ex:4.7.9} we know that \(\tan\) is bijective from \((-\dfrac{\pi}{2}, \dfrac{\pi}{2})\).
  Thus we have
  \begin{align*}
    \tan^{-1}(0) & = \tan^{-1}\bigg(\dfrac{\sin(0)}{\cos(0)}\bigg)          &  & \text{(by \cref{4.7.2}(e))} \\
                 & = \tan^{-1}\big(\tan(0)\big)                             &  & \by{ex:4.7.9}               \\
                 & = 0                                                                                       \\
                 & = \sum_{n = 0}^\infty \dfrac{(-1)^n 0^{2n + 1}}{2n + 1}.
  \end{align*}

  Now suppose that \(x \in (-1, 1)\).
  Observe that
  \[
    x \in (-1, 1) \implies x^2 \in (-1, 1) \implies -x^2 \in (-1, 1).
  \]
  Since
  \begin{align*}
    (\tan^{-1})'(x) & = \dfrac{1}{1 + x^2}                           &                    & \by{ex:4.7.8}             \\
                    & = \dfrac{1}{1 - (-x^2)}                        & (-x^2 \in (-1, 1))                             \\
                    & = \sum_{n = 0}^\infty (-x^2)^n                 &                    & \text{(geometric series)} \\
                    & = \sum_{n = 0}^\infty \big((-1)^n x^{2n}\big),
  \end{align*}
  we know that
  \begin{align*}
     & \tan^{-1}(x)                                                                                                                                  \\
     & = \tan^{-1}(x) - \tan^{-1}(0)                                              & (\tan^{-1}(0) = 0)                                               \\
     & = \int_0^x (\tan^{-1})'(y) \; dy                                           &                    & \text{(by fundamental theorem of calculus)} \\
     & = \int_{0}^x \bigg(\sum_{n = 0}^\infty \big((-1)^n y^{2n}\big)\bigg) \; dy &                    & \text{(by \cref{4.1.6}(c)(e))}              \\
     & = \sum_{n = 0}^\infty \bigg(\int_{0}^x \big((-1)^n y^{2n}\big)\bigg) \; dy &                    & \by{3.6.2}                                  \\
     & = \sum_{n = 0}^\infty \dfrac{(-1)^n (x^{2n + 1} - 0^{2n + 1})}{2n + 1}                                                                        \\
     & = \sum_{n = 0}^\infty \dfrac{(-1)^n x^{2n + 1}}{2n + 1}.
  \end{align*}

  Since the sequence \((\dfrac{1}{2n + 1})_{n = 0}^\infty\) is monotone decreasing, we know that the following series
  \begin{align*}
    \sum_{n = 0}^\infty \dfrac{(-1)^n}{2n + 1}  & = \sum_{n = 0}^\infty \dfrac{(-1)^n 1^{2n + 1}}{2n + 1};                                                      \\
    -\sum_{n = 0}^\infty \dfrac{(-1)^n}{2n + 1} & = \sum_{n = 0}^\infty \dfrac{(-1)^{n + 1}}{2n + 1} = \sum_{n = 0}^\infty \dfrac{(-1)^n (-1)^{2n + 1}}{2n + 1}
  \end{align*}
  are convergent.
  Thus by Abel's theorem (\cref{4.3.1}) we know that
  \[
    \forall x \in [-1, 1], \tan^{-1}(x) = \sum_{n = 0}^\infty \dfrac{(-1)^n x^{2n + 1}}{2n + 1}.
  \]
  Since
  \begin{align*}
    0 & = \cos(\dfrac{\pi}{2})                                                                  &  & \text{(by \cref{4.7.5}(c))} \\
      & = \cos(\dfrac{\pi}{4} + \dfrac{\pi}{4})                                                                                  \\
      & = \cos(\dfrac{\pi}{4}) \cos(\dfrac{\pi}{4}) - \sin(\dfrac{\pi}{4}) \sin(\dfrac{\pi}{4}) &  & \text{(by \cref{4.7.2}(d))}
  \end{align*}
  we know that
  \begin{align*}
             & \big(\sin(\dfrac{\pi}{4})\big)^2 = \big(\cos(\dfrac{\pi}{4})\big)^2                                                                                                          \\
    \implies & \bigg(\dfrac{\sin(\dfrac{\pi}{4})}{\cos(\dfrac{\pi}{4})}\bigg)^2 = \big(\tan(\dfrac{\pi}{4})\big)^2 = 1 &                                                    & \by{ex:4.7.8} \\
    \implies & \tan(\dfrac{\pi}{4}) = 1.                                                                               & (\tan\big((0, \dfrac{\pi}{2})\big) \subseteq \R^+)
  \end{align*}
  Thus we have
  \begin{align*}
             & \dfrac{\pi}{4} = \tan^{-1}\big(\tan(\dfrac{\pi}{4})\big) = \tan^{-1}(1) = \sum_{n = 0}^\infty \dfrac{(-1)^n}{2n + 1} &  & \text{(from the proof above)} \\
    \implies & \pi = 4 \bigg(\sum_{n = 0}^\infty \dfrac{(-1)^n}{2n + 1}\bigg).
  \end{align*}
  This means
  \begin{align*}
    \pi & = 4 \bigg(\sum_{n = 0}^\infty \dfrac{(-1)^n}{2n + 1}\bigg)                                                                                 \\
        & = 4 + 4 \bigg(\sum_{n = 1}^\infty \dfrac{(-1)^n}{2n + 1}\bigg)                                                                             \\
        & = 4 + 4 \bigg(\sum_{n = 0}^\infty \dfrac{(-1)^{n + 1}}{2(n + 1) + 1}\bigg)                                                                 \\
        & = 4 + 4 \bigg(\sum_{n = 0}^\infty \dfrac{(-1)^{n + 1}}{2n + 3}\bigg)                                                                       \\
        & = 4 + 4 \Bigg(\sum_{n = 0}^\infty \bigg(\dfrac{-1}{2(2n) + 3} + \dfrac{1}{2(2n + 1) + 3}\bigg)\Bigg) &  & \text{(grouping each two terms)} \\
        & = 4 + 4 \Bigg(\sum_{n = 0}^\infty \bigg(\dfrac{-1}{4n + 3} + \dfrac{1}{4n + 5}\bigg)\Bigg)                                                 \\
        & = 4 + 4 \Bigg(\sum_{n = 0}^\infty \bigg(\dfrac{-2}{(4n + 3)(4n + 5)}\bigg)\Bigg)                                                           \\
        & = 4 - 4 \Bigg(\sum_{n = 0}^\infty \bigg(\dfrac{2}{(4n + 3)(4n + 5)}\bigg)\Bigg)                                                            \\
        & < 4
  \end{align*}
  and
  \begin{align*}
    \pi & = 4 \bigg(\sum_{n = 0}^\infty \dfrac{(-1)^n}{2n + 1}\bigg)                                                                            \\
        & = 4 \Bigg(\sum_{n = 0}^\infty \bigg(\dfrac{1}{2(2n) + 1} - \dfrac{1}{2(2n + 1) + 1}\bigg)\Bigg) &  & \text{(grouping each two terms)} \\
        & = 4 \Bigg(\sum_{n = 0}^\infty \bigg(\dfrac{1}{4n + 1} - \dfrac{1}{4n + 3}\bigg)\Bigg)                                                 \\
        & = 4 \bigg(\sum_{n = 0}^\infty \dfrac{2}{(4n + 1)(4n + 3)}\bigg)                                                                       \\
        & = \dfrac{8}{3} + 4 \bigg(\sum_{n = 1}^\infty \dfrac{2}{(4n + 1)(4n + 3)}\bigg)                                                        \\
        & = 4 - \dfrac{4}{3} + 4 \bigg(\sum_{n = 1}^\infty \dfrac{2}{(4n + 1)(4n + 3)}\bigg)                                                    \\
        & > 4 - \dfrac{4}{3}.
  \end{align*}
  Thus we conclude that \(\pi \in (\dfrac{4}{3}, 4)\).
\end{proof}

\begin{ex}\label{ex:4.7.10}
  Let \(f : \R \to \R\) be the function
  \[
    f(x) \coloneqq \sum_{n = 1}^\infty \big(4^{-n} \cos(32^n \pi x)\big).
  \]
  \begin{enumerate}
    \item Show that this series is uniformly convergent, and that \(f\) is continuous.
    \item Show that for every integer \(j\) and every integer \(m \geq 1\), we have
          \[
            \abs{f\bigg(\dfrac{j + 1}{32^m}\bigg) - f\bigg(\dfrac{j}{32^m}\bigg)} \geq 4^{-m}.
          \]
    \item Using (b), show that for every real number \(x_0\), the function \(f\) is not differentiable at \(x_0\).
    \item Explain briefly why the result in (c) does not contradict \cref{3.7.3}.
  \end{enumerate}
\end{ex}

\begin{proof}{(a)}
  Since
  \begin{align*}
     & \sum_{n = 1}^\infty \norm*{4^{-n} \cos(32^n \pi x)}_{\infty}                                                       \\
     & = \sum_{n = 1}^\infty \sup\set{\abs{4^{-n} \cos(32^n \pi x)} : x \in \R} &  & \by{3.5.5}                   \\
     & = \sum_{n = 1}^\infty 4^{-n}                                                                                       \\
     & = \dfrac{1}{1 - \dfrac{1}{4}}                                                    &  & \text{(by geometric series)}
  \end{align*}
  By Weierstrass \(M\)-test (\cref{3.5.7}) we know that \(\sum_{n = 1}^\infty \big(4^{-n} \cos(32^n \pi x)\big)\) converges uniformly to \(f\) on \(\R\) with respect to \(d_{l^1}|_{\R \times \R}\).
\end{proof}

\begin{proof}{(b)}
  First we show that
  \[
    \forall x, y \in \R, \abs{\cos(x) - \cos(y)} \leq \abs{x - y}.
  \]
  Fix one pair of \(x, y\) and without the loss of generality suppose that \(y \leq x\).
  By \cref{4.7.2}(a)(b) we know that \(\sin\) is continuous and bounded on \([y, x]\), thus by Corollary 11.5.2 in Analysis I we know that \(\sin\) is Riemann integrable on \([y, x]\).
  Then we have
  \begin{align*}
             & \int_y^x -1 \; dz \leq \int_y^x \sin(z) \; dz \leq \int_y^x 1 \; dz &  & \text{(by \cref{4.7.2}(a))} \\
    \implies & -(x - y) \leq -\big(\cos(x) - \cos(y)\big) \leq x - y               &  & \text{(by \cref{4.7.2}(b))} \\
    \implies & \abs{\cos(x) - \cos(y)} \leq \abs{x - y}.
  \end{align*}
  The case \(x \leq y\) can be proven similarly.

  Define
  \[
    \forall (j, m, n) \in \Z \times \Z^+ \times \Z^+, a_n^{(j, m)} = 4^{-n} \Bigg(\cos\bigg(\dfrac{32^n \pi (j + 1)}{32^m}\bigg) - \cos\bigg(\dfrac{32^n \pi j}{32^m}\bigg)\Bigg).
  \]
  Then we have
  \begin{align*}
     & \abs{f\bigg(\dfrac{j + 1}{32^m}\bigg) - f\bigg(\dfrac{j}{32^m}\bigg)}                                                                                                           \\
     & = \abs{\sum_{n = 1}^\infty \Bigg(4^{-n} \cos\bigg(\dfrac{32^n \pi (j + 1)}{32^m}\bigg)\Bigg) - \sum_{n = 1}^\infty \Bigg(4^{-n} \cos\bigg(\dfrac{32^n \pi j}{32^m}\bigg)\Bigg)} \\
     & = \abs{\sum_{n = 1}^\infty \Bigg(4^{-n} \cos\bigg(\dfrac{32^n \pi (j + 1)}{32^m}\bigg) - 4^{-n} \cos\bigg(\dfrac{32^n \pi j}{32^m}\bigg)\Bigg)}                                 \\
     & = \abs{\sum_{n = 1}^\infty a_n^{(j, m)}}.
  \end{align*}
  Now we split into three cases:
  \begin{itemize}
    \item If \(n < m\), then we have
          \begin{align*}
            \abs{a_n^{(j, m)}} & = \abs{4^{-n} \Bigg(\cos\bigg(\dfrac{32^n \pi (j + 1)}{32^m}\bigg) - \cos\bigg(\dfrac{32^n \pi j}{32^m}\bigg)\Bigg)}                                           \\
                               & \leq \abs{4^{-n} \bigg(\dfrac{32^n \pi (j + 1)}{32^m} - \dfrac{32^n \pi j}{32^m}\bigg)}                              &         & \text{(from the proof above)} \\
                               & = 4^{-n} \dfrac{32^n \pi}{32^m} = \dfrac{8^n \pi}{32^m} = \dfrac{8^n \pi}{8^m 4^m} = \dfrac{\pi}{8^{m - n} 4^m}                                                \\
                               & \leq \dfrac{4}{8^{m - n} 4^m}                                                                                        &         & \by{ex:4.7.9}                 \\
                               & \leq \dfrac{4^{m - n}}{8^{m - n} 4^m}                                                                                & (m > n)                                 \\
                               & = \dfrac{4^{m - n}}{4^{m - n} 2^{m - n} 4^m} = 2^{n - m} 4^{-m}.
          \end{align*}
    \item If \(n = m\), then we have
          \begin{align*}
             & \abs{a_m^{(j, m)}}                                                                                   \\
             & = \abs{4^{-m} \Big(\cos\big(\pi (j + 1)\big) - \cos(\pi j)\Big)}                                     \\
             & = \abs{4^{-m} \big(-2 \cos(\pi j)\big)}                          &  & \text{(by \cref{4.7.5}(a))}    \\
             & = 2 \cdot 4^{-m}.                                                &  & \text{(by \cref{ac:4.7.2}(f))}
          \end{align*}
    \item If \(n > m\), then we have
          \begin{align*}
             & a_n^{(j, m)}                                                                                                         \\
             & = 4^{-n} \Big(\cos\big(32^{n - m} \pi (j + 1)\big) - \cos(32^{n - m} \pi j)\Big)                                     \\
             & = 4^{-n} \Big(\cos(32^{n - m} \pi j + 32^{n - m} \pi) - \cos(32^{n - m} \pi j)\Big)                                  \\
             & = 4^{-n} \Big(\cos(32^{n - m} \pi j) - \cos(32^{n - m} \pi j)\Big)                  &  & \text{(by \cref{4.7.5}(a))} \\
             & = 0.
          \end{align*}
  \end{itemize}
  From all cases above we conclude that
  \begin{align*}
     & \abs{f\bigg(\dfrac{j + 1}{32^m}\bigg) - f\bigg(\dfrac{j}{32^m}\bigg)}                                                                                                  \\
     & = \abs{\sum_{n = 1}^\infty a_n^{(j, m)}}                                                                                                                               \\
     & = \abs{\sum_{n = 1}^{m - 1} a_n^{(j, m)} + a_m^{(j, m)} + \sum_{n = m + 1}^\infty a_n^{(j, m)}}                                                                        \\
     & = \abs{\sum_{n = 1}^{m - 1} a_n^{(j, m)} + a_m^{(j, m)}}                                        &                                      & \text{(from the proof above)} \\
     & \geq \abs{a_m^{(j, m)}} - \abs{\sum_{n = 1}^{m - 1} a_n^{(j, m)}}                               & (\abs{x + y} \geq \abs{x} - \abs{y})                                 \\
     & \geq \abs{a_m^{(j, m)}} - \sum_{n = 1}^{m - 1} \abs{a_n^{(j, m)}}                                                                                                      \\
     & \geq 2 \cdot 4^{-m} - \sum_{n = 1}^{m - 1} (2^{n - m} 4^{-m})                                   &                                      & \text{(from the proof above)} \\
     & = 2 \cdot 4^{-m} - 4^{-m} \bigg(\sum_{n = 1}^{m - 1} 2^{n - m}\bigg)                                                                                                   \\
     & \geq 2 \cdot 4^{-m} - 4^{-m} \bigg(\sum_{n = 1}^\infty 2^{-n}\bigg)                                                                                                    \\
     & = 2 \cdot 4^{-m} - 4^{-m} \bigg(-1 + \sum_{n = 0}^\infty 2^{-n}\bigg)                                                                                                  \\
     & = 2 \cdot 4^{-m} - 4^{-m} \bigg(-1 + \dfrac{1}{1 - \dfrac{1}{2}}\bigg)                          &                                      & \text{(geometric series)}     \\
     & = 2 \cdot 4^{-m} - 4^{-m} = 4^{-m}.
  \end{align*}
\end{proof}

\begin{proof}{(c)}
  Suppose for sake of contradiction that there exists a \(x_0 \in \R\) such that \(f'(x_0) \in \R\).
  Then by Proposition 10.1.7 in Analysis I we have
  \begin{align*}
     & \forall \varepsilon \in \R^+, \exists \delta \in \R^+ :                                                                          \\
     & \forall x \in \R, \abs{x - x_0} < \delta \implies \abs{\big(f(x) - f(x_0)\big) - f'(x_0) (x - x_0)} < \varepsilon \abs{x - x_0}.
  \end{align*}
  In particular, we have
  \begin{align*}
             & \exists \delta \in \R^+ : \forall x \in \R, \abs{x - x_0} < \delta                                        \\
    \implies & \abs{f(x) - f(x_0) - f'(x_0) (x - x_0)} < \abs{x - x_0}                                                   \\
    \implies & \abs{f(x) - f(x_0)} - \abs{f'(x_0) (x - x_0)} < \abs{x - x_0}      & (\abs{a} - \abs{b} \leq \abs{a - b}) \\
    \implies & \abs{f(x) - f(x_0)} < \abs{f'(x_0) (x - x_0)} + \abs{x - x_0}                                             \\
    \implies & \abs{f(x) - f(x_0)} < \big(\abs{f'(x_0)} + 1\big) \abs{x - x_0}.
  \end{align*}
  Fix such \(\delta\).
  Since \(\lim_{m \to \infty} 32^m = +\infty\), we know that
  \[
    \exists m_1 \in \Z^+ : 32^{m_1} > \dfrac{1}{\delta} \implies \exists m_1 \in \Z^+ : \dfrac{1}{32^{m_1}} < \delta.
  \]
  Similarly, since \(\lim_{m \to \infty} 8^m = +\infty\), we know that
  \[
    \exists m_2 \in \Z^+ : 8^{m_2} > \abs{f'(x_0)} + 1.
  \]
  Let \(m = \max(m_1, m_2)\).
  By Exercise 5.4.3 in Analysis I we know that
  \begin{align*}
             & 32^m x_0 \in \R                                                    \\
    \implies & \exists j \in \Z : j \leq 32^m x_0 < j + 1                         \\
    \implies & \exists j \in \Z : \dfrac{j}{32^m} \leq x_0 < \dfrac{j + 1}{32^m}.
  \end{align*}
  Fix such \(j\).
  Then we have
  \begin{align*}
             & \dfrac{j + 1}{32^m} - \dfrac{j}{32^m} = \dfrac{1}{32^m} < \delta                                                                               \\
    \implies & \begin{dcases}
                 \dfrac{j + 1}{32^m} - x_0 < \delta \\
                 x_0 - \dfrac{j}{32^m} < \delta
               \end{dcases}                                                                                                             \\
    \implies & \begin{dcases}
                 \abs{f\bigg(\dfrac{j + 1}{32^m}\bigg) - f(x_0)} < \big(\abs{f'(x_0)} + 1\big) \bigg(\dfrac{j + 1}{32^m} - x_0\bigg) \\
                 \abs{f\bigg(\dfrac{j}{32^m}\bigg) - f(x_0)} < \big(\abs{f'(x_0)} + 1\big) \bigg(x_0 - \dfrac{j}{32^m}\bigg)
               \end{dcases} &  & \text{(from the proof above)}                        \\
    \implies & 4^{-m} \leq \abs{f\bigg(\dfrac{j + 1}{32^m}\bigg) - f\bigg(\dfrac{j}{32^m}\bigg)}                                          &  & \by{ex:4.7.10} \\
             & \leq \abs{f\bigg(\dfrac{j + 1}{32^m}\bigg) - f(x_0)} + \abs{f\bigg(\dfrac{j}{32^m}\bigg) - f(x_0)}                                             \\
             & < \dfrac{\abs{f'(x_0)} + 1}{32^m}                                                                                                              \\
    \implies & 8^m < \abs{f'(x_0)} + 1.
  \end{align*}
  But this contradict to the fact that \(8^m > \abs{f'(x_0)} + 1\).
  Thus such \(x_0\) does not exist and \(f\) is not differentiable on \(\R\).
\end{proof}

\begin{proof}{(d)}
  Let \(f_n(x) = 4^{-n} \cos(32^n \pi x)\) for all \(n \in \Z^+\).
  By \cref{4.7.2}(b) we know that \(f_n\) is differentiable on \(\R\) and by chain rule we have
  \[
    \forall n \in \Z^+, f_n'(x) = 4^{-n} \big(-\sin(32^n \pi x)\big) (32^n \pi) = - 8^n \pi \sin(32^n \pi x).
  \]
  Since
  \begin{align*}
    \sum_{n = 1}^\infty \norm*{f_n'}_\infty & = \sum_{n = 1}^\infty \sup\set{\abs{f_n'(x)} : x \in \R} &  & \by{3.5.5}             \\
                                            & = \sum_{n = 1}^\infty 8^n \pi                                                        \\
                                            & = +\infty,                                               &  & \text{(by ratio test)}
  \end{align*}
  the condition in \cref{3.7.3} is not satisfied.
  Thus this does not contradict to \cref{3.7.3}.
\end{proof}