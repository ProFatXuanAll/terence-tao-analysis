\section{Real analytic functions}\label{sec:4.2}

\begin{defn}[Real analytic functions]\label{4.2.1}
  Let \(E\) be a subset of \(\R\), and let \(f : E \to \R\) be a function.
  If \(a\) is an interior point of \(E\), we say that \(f\) is \emph{real analytic at \(a\)} if there exists an open interval \((a - r, a + r)\) in \(E\) for some \(r > 0\) such that there exists a power series \(\sum_{n = 0}^\infty c_n (x - a)^n\) centered at \(a\) which has a radius of convergence greater than or equal to \(r\), and which converges to \(f\) on \((a - r, a + r)\).
  If \(E\) is an open set, and \(f\) is real analytic at every point \(a\) of \(E\), we say that \(f\) is \emph{real analytic on \(E\)}.
\end{defn}

\begin{eg}\label{4.2.2}
  Consider the function \(f : \R \setminus \set{1} \to \R\) defined by \(f(x) \coloneqq \dfrac{1}{1 - x}\).
  This function is real analytic at \(0\) because we have a power series \(\sum_{n = 0}^\infty x^n\) centred at \(0\) which converges to \(\dfrac{1}{1 - x} = f(x)\) on the interval \((-1, 1)\).
  This function is also real analytic at \(2\) because we have a power series \(\sum_{n = 0}^\infty (-1)^{n + 1} (x - 2)^n\) which converges to \(\dfrac{-1}{1 - \big(-(x - 2)\big)} = \dfrac{1}{1 - x} = f(x)\) on the interval \((1, 3)\)
  (why? use Lemma 7.3.3 in Analysis I).
  In fact this function is real analytic on all of \(\R \setminus \set{1}\);
  see \cref{ex:4.2.2}.
\end{eg}

\begin{rmk}\label{4.2.3}
  The notion of being real analytic is closely related to another notion, that of being \emph{complex analytic}, but this is a topic for complex analysis, and will not be discussed here.
\end{rmk}

\begin{note}
  From \cref{4.1.6}(c) and (d) we see that if \(f\) is real analytic at a point \(a\), then \(f\) is both continuous and diï¬€erentiable on \((a - r, a + r)\) for some \(r > 0\).
\end{note}

\begin{defn}[\(k\)-times differentiability]\label{4.2.4}
  Let \(E\) be a subset of \(\R\) with the property that every element of \(E\) is a limit point of \(E\).
  We say a function \(f : E \to \R\) is \emph{once differentiable on \(E\)} iff it is differentiable, in particular \(f': E \to \R\) is also a function on \(E\).
  More generally, for any \(k \geq 2\) we say that \(f : E \to \R\) is \emph{\(k\) times differentiable on \(E\)}, or just \emph{\(k\) times differentiable}, iff \(f\) is differentiable, and \(f'\) is \(k - 1\) times differentiable.
  If \(f\) is \(k\) times differentiable, we define the \(k^{\text{th}}\) derivative \(f^{(k)} : E \to \R\) by the recursive rule \(f^{(1)} \coloneqq f'\), and \(f^{(k)} = (f^{(k - 1)})'\) for all \(k \geq 2\).
  We also define \(f^{(0)} \coloneqq f\) (this is \(f\) differentiated \(0\) times), and we allow every function to be zero times differentiable (since clearly \(f^{(0)}\) exists for every \(f\)).
  A function is said to be \emph{infinitely differentiable} (or \emph{smooth}) iff it is \(k\) times differentiable for every \(k \geq 0\).
\end{defn}

\begin{ac}\label{ac:4.2.1}
  For each \(k \in \N\), we have
  \[
    \lim_{n \to \infty} \bigg(\dfrac{(n + k)!}{n!}\bigg)^{\dfrac{1}{n}} = 1.
  \]
\end{ac}

\begin{proof}
  We use induction on \(k\).
  For \(k = 0\), we have
  \[
    \lim_{n \to \infty} \bigg(\dfrac{(n + 0)!}{n!}\bigg)^{\dfrac{1}{n}} = \lim_{n \to \infty} 1^{\dfrac{1}{n}} = \lim_{n \to \infty} 1 = 1.
  \]
  Thus the base case holds.
  Suppose inductively that
  \[
    \lim_{n \to \infty} \bigg(\dfrac{(n + k)!}{n!}\bigg)^{\dfrac{1}{n}} = 1
  \]
  for some \(k \geq 0\).
  We want to show that \(k + 1\) is also true.
  Observe that
  \begin{align*}
             & \exists N \in \Z^+ : \forall n \geq N, Nn > k + 1                                                           \\
    \implies & \exists N \in \Z^+ : \forall n \geq N, (N + 1)n > n + k + 1                                                 \\
    \implies & \exists N \in \Z^+ : \forall n \geq N, Nn > n + k + 1 > n                                                   \\
    \implies & \exists N \in \Z^+ : \forall n \geq N, (Nn)^{\dfrac{1}{n}} > (n + k + 1)^{\dfrac{1}{n}} > n^{\dfrac{1}{n}}.
  \end{align*}
  Now we fix such \(N\).
  Since
  \begin{align*}
             & \begin{dcases}
                 \lim_{n \to \infty} N^{\dfrac{1}{n}} = 1 \\ %&  & \text{(by Lemma 6.5.3 in Analysis I)} \\
                 \lim_{n \to \infty} n^{\dfrac{1}{n}} = 1 %&  & \text{(by Lemma 7.5.4 in Analysis I)}
               \end{dcases}                                \\
    \implies & \lim_{n \to \infty} (Nn)^{\dfrac{1}{n}} = 1                                                                          \\
    \implies & \lim_{n \to \infty} (n + k + 1)^{\dfrac{1}{n}} = 1,                                    &  & \text{(by squeeze test)}
  \end{align*}
  we have
  \begin{align*}
             & \lim_{n \to \infty} \bigg(\dfrac{(n + k)!}{n!}\bigg)^{\dfrac{1}{n}} = 1                                                                        &  & \byIH \\
    \implies & \Bigg(\lim_{n \to \infty} \bigg(\dfrac{(n + k)!}{n!}\bigg)^{\dfrac{1}{n}}\Bigg) \bigg(\lim_{n \to \infty} (n + k + 1)^{\dfrac{1}{n}}\bigg) = 1            \\
    \implies & \lim_{n \to \infty} \Bigg(\bigg(\dfrac{(n + k)!}{n!}\bigg)^{\dfrac{1}{n}} (n + k + 1)^{\dfrac{1}{n}}\Bigg) = 1                                            \\
    \implies & \lim_{n \to \infty} \bigg(\dfrac{(n + k + 1)!}{n!}\bigg)^{\dfrac{1}{n}} = 1.
  \end{align*}
  This closes the induction.
\end{proof}

\setcounter{thm}{5}
\begin{prop}[Real analytic functions are \(k\)-times differentiable]\label{4.2.6}
  Let \(E\) be a subset of \(\R\), let \(a\) be an interior point of \(E\), and and let \(f\) be a function which is real analytic at \(a\), thus there is an \(r > 0\) for which we have the power series expansion
  \[
    f(x) = \sum_{n = 0}^\infty c_n (x - a)^n
  \]
  for all \(x \in (a - r, a + r)\).
  Then for every \(k \geq 0\), the function \(f\) is \(k\)-times differentiable on \((a - r, a + r)\), and for each \(k \geq 0\) the \(k^{\text{th}}\) derivative is given by
  \begin{align*}
    f^{(k)}(x) & = \sum_{n = 0}^\infty c_{n + k} (n + 1) (n + 2) \dots (n + k) (x - a)^n \\
               & = \sum_{n = 0}^\infty c_{n + k} \dfrac{(n + k)!}{n!} (x - a)^n
  \end{align*}
  for all \(x \in (a - r, a + r)\).
\end{prop}

\begin{proof}
  Let \(R\) be the radius of convergence of \(f\).
  By \cref{4.2.1} we know that \(r \leq R\) and thus
  \[
    \forall x \in (a - r, a + r), \abs{x - a} < r \leq R.
  \]
  We use induction on \(k\).
  For \(k = 0\), by \cref{4.2.4} we have
  \[
    \forall x \in (a - r, a + r), f^{(0)}(x) = f(x) = \sum_{n = 0}^\infty c_n (x - a)^n = \sum_{n = 0}^\infty c_{n + 0} \dfrac{(n + 0)!}{n!} (x - a)^n.
  \]
  Thus the base case holds.
  Suppose inductively that
  \[
    \forall x \in (a - r, a + r), f^{(k)}(x) = \sum_{n = 0}^\infty c_{n + k} \dfrac{(n + k)!}{n!} (x - a)^n
  \]
  for some \(k \geq 0\).
  By \cref{ac:4.2.1} we know that
  \begin{align*}
             & \limsup_{n \to \infty} \abs{c_{n + k}}^{\dfrac{1}{n}} = \limsup_{n \to \infty} \abs{c_n}^{\dfrac{1}{n}} = \dfrac{1}{R}                                              \\
    \implies & \Bigg(\limsup_{n \to \infty} \abs{c_{n + k}}^{\dfrac{1}{n}}\Bigg) \Bigg(\limsup_{n \to \infty} \bigg(\dfrac{(n + k)!}{n!}\bigg)^{\dfrac{1}{n}}\Bigg) = \dfrac{1}{R} \\
    \implies & \limsup_{n \to \infty} \abs{c_{n + k} \dfrac{(n + k)!}{n!}}^{\dfrac{1}{n}} = \dfrac{1}{R}.
  \end{align*}
  Thus by \cref{4.1.6}(b) we know that \(f^{(k)}(x)\) converges for all \(x \in (a - r, a + r)\).
  Now we define
  \[
    \forall n \in \N, b_n = c_{n + k} \dfrac{(n + k)!}{n!}.
  \]
  Then by \cref{4.1.6}(d) we have
  \begin{align*}
             & \forall x \in (a - r, a + r), f^{(k)}(x) = \sum_{n = 0}^\infty c_{n + k} \dfrac{(n + k)!}{n!} (x - a)^n = \sum_{n = 0}^\infty b_n (x - a)^n                     \\
    \implies & \forall x \in (a - r, a + r), f^{(k + 1)}(x) = (f^{(k)})'(x) = \sum_{n = 1}^\infty n b_n (x - a)^{n - 1}                                                        \\
    \implies & \forall x \in (a - r, a + r), f^{(k + 1)}(x) = \sum_{n = 1}^\infty n c_{n + k} \dfrac{(n + k)!}{n!} (x - a)^{n - 1}                                             \\
    \implies & \forall x \in (a - r, a + r), f^{(k + 1)}(x) = \sum_{n = 1}^\infty c_{n + k} \dfrac{(n + k)!}{(n - 1)!} (x - a)^{n - 1}                                         \\
    \implies & \forall x \in (a - r, a + r), f^{(k + 1)}(x) = \sum_{n = 0}^\infty c_{(n + 1) + k} \dfrac{\big((n + 1) + k\big)!}{\big((n + 1) - 1\big)!} (x - a)^{(n + 1) - 1} \\
    \implies & \forall x \in (a - r, a + r), f^{(k + 1)}(x) = \sum_{n = 0}^\infty c_{n + k + 1} \dfrac{(n + k + 1)!}{n!} (x - a)^n
  \end{align*}
  and this closes the induction.
\end{proof}

\begin{cor}[Real analytic functions are infinitely differentiable]\label{4.2.7}
  Let \(E\) be an open subset of \(\R\), and let \(f : E \to \R\) be a real analytic function on \(E\).
  Then \(f\) is infinitely differentiable on \(E\).
  Also, all derivatives of \(f\) are also real analytic on \(E\).
\end{cor}

\begin{proof}
  For every point \(a \in E\) and \(k \geq 0\), we know from \cref{4.2.6} that \(f\) is \(k\)-times differentiable at \(a\)
  (we will have to apply Exercise 10.1.1 in Analysis I \(k\) times here).
  Thus \(f\) is \(k\)-times differentiable on \(E\) for every \(k \geq 0\) and is hence infinitely differentiable.
  Also, from \cref{4.2.6} we see that each derivative \(f^{(k)}\) of \(f\) has a convergent power series expansion at every \(x \in E\) and thus \(f^{(k)}\) is real analytic.
\end{proof}

\setcounter{thm}{8}
\begin{rmk}\label{4.2.9}
  The converse statement to \cref{4.2.7} is not true;
  there are infinitely differentiable functions which are not real analytic.
\end{rmk}

\begin{note}
  \cref{4.2.6} has an important corollary (\cref{4.2.10}), due to Brook Taylor (1685 -- 1731).
\end{note}

\begin{cor}[Taylor's formula]\label{4.2.10}
  Let \(E\) be a subset of \(\R\), let \(a\) be an interior point of \(E\), and let \(f : E \to \R\) be a function which is real analytic at \(a\) and has the power series expansion
  \[
    f(x) = \sum_{n = 0}^\infty c_n (x - a)^n
  \]
  for all \(x \in (a - r, a + r)\) and some \(r > 0\).
  Then for any integer \(k \geq 0\), we have
  \[
    f^{(k)}(a) = k! c_k,
  \]
  where \(k! \coloneqq 1 \times 2 \times \dots \times k\)
  (and we adopt the convention that \(0! = 1\)).
  In particular, we have Taylor's formula
  \[
    f(x) = \sum_{n = 0}^\infty \dfrac{f^{(n)}(a)}{n!} (x - a)^n
  \]
  for all \(x\) in \((a - r, a + r)\).
\end{cor}

\begin{proof}
  We have
  \begin{align*}
    \forall k \in \N, f^{(k)}(a) & = \sum_{n = 0}^\infty c_{n + k} \dfrac{(n + k)!}{n!} (a - a)^n &           & \by{4.2.6} \\
                                 & = c_k k!                                                       & (0^0 = 1)
  \end{align*}
  and thus
  \begin{align*}
    \forall x \in (a - r, a + r), f(x) & = \sum_{n = 0}^\infty c_n (x - a)^n                                                        \\
                                       & = \sum_{n = 0}^\infty \dfrac{c_n n!}{n!} (x - a)^n                                         \\
                                       & = \sum_{n = 0}^\infty \dfrac{f^{(n)}(a)}{n!} (x - a)^n. &  & \text{(from the proof above)}
  \end{align*}
\end{proof}

\begin{note}
  The power series \(\sum_{n = 0}^\infty \dfrac{f^{(n)}(a)}{n!} (x - a)^n\) is sometimes called the \emph{Taylor series} of \(f\) around \(a\).
  Taylor's formula thus asserts that if a function is real analytic, then it is equal to its Taylor series.
\end{note}

\begin{rmk}\label{4.2.11}
  Note that Taylor's formula only works for functions which are real analytic;
  there are examples of functions which are infinitely differentiable but for which Taylor's theorem fails.
\end{rmk}

\begin{cor}[Uniqueness of power series]\label{4.2.12}
  Let \(E\) be a subset of \(\R\), let \(a\) be an interior point of \(E\), and let \(f : E \to \R\) be a function which is real analytic at \(a\).
  Suppose that \(f\) has two power series expansions
  \[
    f(x) = \sum_{n = 0}^\infty c_n (x - a)^n
  \]
  and
  \[
    f(x) = \sum_{n = 0}^\infty d_n (x - a)^n
  \]
  centered at \(a\), each with a non-zero radius of convergence.
  Then \(c_n = d_n\) for all \(n \geq 0\).
\end{cor}

\begin{proof}
  By \cref{4.2.10}, we have \(f^{(k)}(a) = k! c_k\) for all \(k \geq 0\).
  But we also have \(f^{(k)}(a) = k! d_k\), by similar reasoning.
  Since \(k!\) is never zero, we can cancel it and obtain \(c_k = d_k\) for all \(k \geq 0\), as desired.
\end{proof}

\begin{rmk}\label{4.2.13}
  While a real analytic function has a unique power series around any given point, it can certainly have different power series at different points.
  For instance, the function \(f(x) \coloneqq \dfrac{1}{1 - x}\), defined on \(\R \setminus \set{1}\), has the power series
  \[
    f(x) \coloneqq \sum_{n = 0}^\infty x^n
  \]
  around \(0\), on the interval \((-1, 1)\), but also has the power series
  \begin{align*}
    f(x) & = \dfrac{1}{1 - x}                                                  \\
         & = \dfrac{2}{1 - 2(x - \dfrac{1}{2})}                                \\
         & = \sum_{n = 0}^\infty 2 \bigg(2\bigg(x - \dfrac{1}{2}\bigg)\bigg)^n \\
         & = \sum_{n = 0}^\infty 2^{n + 1} \bigg(x - \dfrac{1}{2}\bigg)^n
  \end{align*}
  around \(1 / 2\), on the interval \((0, 1)\)
  (note that the above power series has a radius of convergence of \(1 / 2\), thanks to the root test).
\end{rmk}

\exercisesection

\begin{ex}\label{ex:4.2.1}
  Let \(n \geq 0\) be an integer, let \(c, a\) be real numbers, and let \(f\) be the function \(f(x) \coloneqq c (x - a)^n\).
  Show that \(f\) is infinitely differentiable, and that \(f^{(k)}(x) = c \dfrac{n!}{(n - k)!} (x - a)^{n - k}\) for all integers \(0 \leq k \leq n\).
  What happens when \(k > n\)?
\end{ex}

\begin{proof}
  For each \(n \in \N\), let \(P(n)\) be the statement ``If \(f(x) = c (x - a)^n\), then \(f^{(k)}(x) = c \dfrac{n!}{(n - k)!} (x - a)^{n - k}\) for all \(0 \leq k \leq n\)''.
  We use induction on \(n\) to show that \(P(n)\) is true for all \(n \in \N\).
  For \(n = 0\), we have \(0 \leq k \leq 0 \implies k = 0\).
  By \cref{4.2.4} we have
  \[
    f^{(0)} = f = c (x - a)^0 = c = c \dfrac{0!}{(0 - 0)!} (x - a)^{0 - 0}
  \]
  and thus the base case holds.
  Suppose inductive that \(P(n)\) is true for some \(n \geq 0\).
  Then we want to show that \(P(n + 1)\) is true.
  Let \(f(x) = c (x - a)^{n + 1}\).
  Then we have
  \[
    f'(x) = c (n + 1) (x - a)^n.
  \]
  By induction hypothesis we know that
  \begin{align*}
             & \dfrac{f'(x)}{n + 1} = c (x - a)^n                                                                                       \\
    \implies & \forall 0 \leq k \leq n, \bigg(\dfrac{f'(x)}{n + 1}\bigg)^{(k)} = c \dfrac{n!}{(n - k)!} (x - a)^{n - k}                 \\
    \implies & \forall 0 \leq k \leq n, \big(f'(x)\big)^{(k)} = c \dfrac{(n + 1)!}{(n - k)!} (x - a)^{n - k}                            \\
    \implies & \forall 0 \leq k \leq n, f(x)^{(k + 1)} = c \dfrac{(n + 1)!}{(n - k)!} (x - a)^{n - k}                   &  & \by{4.2.4} \\
    \implies & \forall 1 \leq k \leq n + 1,                                                                                             \\
             & f(x)^{\big((k - 1) + 1\big)} = c \dfrac{(n + 1)!}{\big(n - (k - 1)\big)!} (x - a)^{n - (k - 1)}                          \\
    \implies & \forall 1 \leq k \leq n + 1, f(x)^{(k)} = c \dfrac{(n + 1)!}{(n + 1 - k)!} (x - a)^{n + 1 - k}
  \end{align*}
  and we know that
  \[
    f(x)^{(0)} = f(x) = c (x - a)^{n + 1} = c \dfrac{(n + 1)!}{(n + 1 - 0)!} (x - a)^{n + 1 - 0}.
  \]
  Thus we have
  \[
    \forall 0 \leq k \leq n + 1, f(x)^{(k)} = c \dfrac{(n + 1)!}{(n + 1 - k)!} (x - a)^{n + 1 - k}
  \]
  and this closes the induction.

  Now let \(n \in \N\) and let \(f(x) = c (x - a)^n\).
  From the proof above we know that
  \[
    f^{(n)}(x) = c \dfrac{n!}{(n - n)!} (x - a)^{n - n} = c n!
  \]
  is a constant function.
  Thus we have
  \[
    \forall k > n, f^{(k)}(x) = 0
  \]
  and by \cref{4.2.4} \(f\) is infinitely differentiable.
\end{proof}

\begin{ex}\label{ex:4.2.2}
  Show that the function \(f\) defined in \cref{4.2.2} is real analytic on all of \(\R \setminus \set{1}\).
\end{ex}

\begin{proof}
  Let \(a \in \R \setminus \set{1}\), let \(r = \abs{1 - a}\), let \(x \in (a - r, a + r)\) and let \(c_n = (\dfrac{1}{1 - a})^{n + 1}\) for all \(n \in \N\).
  Then we have
  \begin{align*}
             & a - r < x < a + r              \\
    \implies & \abs{x - a} < r                \\
    \implies & \abs{\dfrac{x - a}{1 - a}} < 1
  \end{align*}
  and by Lemma 7.3.3 in Analysis I we know that
  \begin{align*}
    \sum_{n = 0}^\infty c_n (x - a)^n & = \sum_{n = 0}^\infty \bigg(\dfrac{1}{1 - a}\bigg)^{n + 1} (x - a)^n      \\
                                      & = \dfrac{1}{1 - a} \sum_{n = 0}^\infty \bigg(\dfrac{x - a}{1 - a}\bigg)^n \\
                                      & = \dfrac{1}{1 - a} \dfrac{1}{1 - \dfrac{x - a}{1 - a}}                    \\
                                      & = \dfrac{1}{1 - x}.
  \end{align*}
  Since \(x\) is arbitrary, we know that \(\sum_{n = 0}^\infty c_n (x - a)^n\) converges to \(f\) on \((a - r, a + r)\).
  By \cref{4.2.1} we know that \(f\) is real analytic at \(a\).
  Since \(a\) is arbitrary, by \cref{4.2.1} we know that \(f\) is real analysis at \(a\) for each \(a \in \R \setminus \set{1}\).
\end{proof}

\begin{ex}\label{ex:4.2.3}
  Prove \cref{4.2.6}.
\end{ex}

\begin{proof}
  See \cref{4.2.6}.
\end{proof}

\begin{ex}\label{ex:4.2.4}
  Use \cref{4.2.6} and \cref{ex:4.2.1} to prove \cref{4.2.10}.
\end{ex}

\begin{proof}
  See \cref{4.2.10}.
\end{proof}

\begin{ex}\label{ex:4.2.5}
  Let \(a, b\) be real numbers, and let \(n \geq 0\) be an integer.
  Prove the identity
  \[
    (x - a)^n = \sum_{m = 0}^n \dfrac{n!}{m! (n - m)!} (b - a)^{n - m} (x - b)^m
  \]
  or any real number \(x\).
  Explain why this identity is consistent with Taylor's theorem and \cref{ex:4.2.1}.
  (Note however that Taylor's theorem cannot be rigorously applied until one verifies \cref{ex:4.2.6} below.)
\end{ex}

\begin{proof}
  Let \(f : \R \to \R\) be the function by setting \(f(x) = (x - a)^n\) for all \(x \in \R\).
  By Exercise 7.1.4 in Analysis I we have
  \begin{align*}
    \forall x \in \R, f(x) & = (x - a)^n                                                         \\
                           & = (x - b + b - a)^n                                                 \\
                           & = \sum_{m = 0}^n \dfrac{n!}{m! (n - m)!} (x - b)^m (b - a)^{n - m}.
  \end{align*}
  If we define
  \[
    \forall m \in \N, c_m = \begin{dcases}
      \dfrac{n! (b - a)^{n - m}}{m! (n - m)!} & \text{if } m \leq n \\
      0                                       & \text{if } m > n
    \end{dcases}
  \]
  then we have
  \[
    \forall x \in \R, f(x) = \sum_{m = 0}^\infty c_m (x - b)^m = \sum_{m = 0}^n c_m (x - b)^m.
  \]
  Thus for arbitrary \(r \in \R^+\), \(\sum_{m = 0}^\infty c_m (x - b)^m\) converges to \(f(x)\) for all \(x \in (b - r, b + r)\).
  By \cref{4.2.1} we know that \(f\) is real analytic at \(b\).
  By \cref{4.2.10} we have
  \begin{align*}
    \forall x \in \R, f(x) = \sum_{m = 0}^\infty \dfrac{f^{(m)}(b)}{m!} (x - b)^m.
  \end{align*}
  By \cref{ex:4.2.1} we have
  \[
    \forall m \in \N, \forall x \in \R, f^{(m)}(x) = \begin{dcases}
      \dfrac{n!}{(n - m)!} (x - a)^{n - m} & \text{if } 0 \leq m \leq n \\
      0                                    & \text{if } m > n
    \end{dcases}
  \]
  Thus
  \begin{align*}
    \forall x \in \R, f(x) & = \sum_{m = 0}^\infty \dfrac{f^{(m)}(b)}{m!} (x - b)^m              \\
                           & = \sum_{m = 0}^n \dfrac{f^{(m)}(b)}{m!} (x - b)^m                   \\
                           & = \sum_{m = 0}^n \dfrac{n!}{m! (n - m)!} (x - b)^m (b - a)^{n - m}.
  \end{align*}
\end{proof}

\begin{ex}\label{ex:4.2.6}
  Using \cref{ex:4.2.5}, show that every polynomial \(P(x)\) of one variable is real analytic on \(\R\).
\end{ex}

\begin{proof}
  Let \(P : \R \to \R\) be a polynomial with degree \(n\).
  First we show that \(P\) is real analytic at \(0\).
  By \cref{3.8.1} we know that
  \[
    \forall x \in \R, P(x) = \sum_{i = 0}^n c_i x^i
  \]
  where \(c_0, \dots, c_n \in \R\) and \(c_n \neq 0\).
  If we define \(c_i = 0\) for all \(i > n\), then we have
  \[
    \forall x \in \R, \sum_{i = 0}^\infty c_i (x - 0)^i = \sum_{i = 0}^\infty c_i x^i = \sum_{i = 0}^n c_i x^i = P(x).
  \]
  Thus for arbitrary \(r \in \R^+\), \(\sum_{i = 0}^\infty c_i (x - 0)^i\) converges to \(P(x)\) for all \(x \in (-r, r)\).
  By \cref{4.2.1} \(P\) is real analytic at \(0\).

  Now we show that \(P\) is real analytic at \(a \in \R \setminus \set{0}\).
  Since \(a \neq 0\), we have
  \begin{align*}
    \forall x \in \R, P(x) & = \sum_{i = 0}^n c_i x^i                                                                                                       \\
                           & = \sum_{i = 0}^n c_i \bigg(\sum_{m = 0}^i \dfrac{i!}{m! (i - m)!} a^{i - m} (x - a)^m\bigg)                 &  & \by{ex:4.2.5} \\
                           & = \sum_{i = 0}^n c_i \bigg(\sum_{m = 0}^i \dfrac{i!}{m! (i - m)!} a^{i - m} (x - a)^{m - i}\bigg) (x - a)^i
  \end{align*}
  If we define
  \[
    \forall i \in \N, d_i = \begin{dcases}
      c_i \bigg(\sum_{m = 0}^i \dfrac{i!}{m! (i - m)!} a^{i - m} (x - a)^{m - i}\bigg) & \text{if } 0 \leq i \leq n \\
      0                                                                                & \text{if } i > n
    \end{dcases}
  \]
  Then we have
  \[
    \forall x \in \R, \sum_{i = 0}^\infty d_i (x - a)^i = \sum_{i = 0}^n d_i (x - a)^i = P(x).
  \]
  Thus for arbitrary \(r \in \R^+\), \(\sum_{i = 0}^\infty d_i (x - a)^i\) converges to \(P(x)\) for all \(x \in (-r, r)\).
  By \cref{4.2.1} \(P\) is real analytic at \(a\).
  Combine the proof above we conclude that \(P\) is real analytic on \(\R\).
  Since \(P\) is arbitrary, we conclude that polynomials of one variable are real analytic on \(\R\).
\end{proof}

\begin{ex}\label{ex:4.2.7}
  Let \(m \geq 0\) be a positive integer, and let \(0 < x < r\) be real numbers.
  Use Lemma 7.3.3 in Analysis I to establish the identity
  \[
    \dfrac{r}{r - x} = \sum_{n = 0}^\infty x^n r^{-n}
  \]
  for all \(x \in (-r, r)\).
  Using \cref{4.2.6}, conclude the identity
  \[
    \dfrac{r}{(r - x)^{m + 1}} = \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} x^{n - m} r^{-n}
  \]
  for all integers \(m \geq 0\) and \(x \in (-r, r)\).
  Also explain why the series on the right-hand side is absolutely convergent.
\end{ex}

\begin{proof}
  By Lemma 7.3.3 in Analysis I we have
  \begin{align*}
             & 0 < x < r                                                                                                                         \\
    \implies & \dfrac{x}{r} < 1                                                                                                                  \\
    \implies & \sum_{n = 0}^\infty \bigg(\dfrac{x}{r}\bigg)^n = \sum_{n = 0}^\infty x^n r^{-n} = \dfrac{1}{1 - \dfrac{x}{r}} = \dfrac{r}{r - x}.
  \end{align*}
  Since
  \[
    x = 0 \implies \sum_{n = 0}^\infty 0^n r^{-n} = 0^0 r^{0} + \sum_{n = 1}^\infty 0^n r^{-n} = 1 = \dfrac{r}{r - 0},
  \]
  we know that
  \[
    \forall x \in (-r, r), \dfrac{r}{r - x} = \sum_{n = 0}^\infty x^n r^{-n}
  \]
  and by \cref{4.2.1} \(x \mapsto \dfrac{r}{r - x}\) is real analytic at \(0\).

  Next we use induction on \(m\) to show that
  \[
    \forall m \in \N, \forall x \in (-r, r), \bigg(y \mapsto \dfrac{r}{r - y}\bigg)^{(m)}(x) = \dfrac{m! r}{(r - x)^{m + 1}}.
  \]
  For \(m = 0\), we have
  \[
    \forall x \in (-r, r), \bigg(y \mapsto \dfrac{r}{r - y}\bigg)^{(0)}(x) = \dfrac{r}{r - x} = \dfrac{0! r}{(r - x)^{0 + 1}}
  \]
  and thus the base case holds.
  Suppose inductively that
  \[
    \forall x \in (-r, r), \bigg(y \mapsto \dfrac{r}{r - y}\bigg)^{(m)}(x) = \dfrac{m! r}{(r - x)^{m + 1}}
  \]
  for some \(m \geq 0\).
  Then by \cref{4.2.4} we have
  \[
    \forall x \in (-r, r), \bigg(y \mapsto \dfrac{r}{r - y}\bigg)^{(m + 1)}(x) = \bigg(\dfrac{m! r}{(r - x)^{m + 1}}\bigg)'(x) = \dfrac{(m + 1)! r}{(r - x)^{m + 2}}.
  \]
  This closes the induction.

  Now we show that
  \[
    \forall m \in \N, \dfrac{r}{(r - x)^{m + 1}} = \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} x^{n - m} r^{-n}.
  \]
  From the proof above we know that
  \[
    \forall m \in \N, \forall x \in (-r, r), \dfrac{r}{(r - x)^{m + 1}} = \dfrac{1}{m!} \bigg(y \mapsto \dfrac{r}{r - y}\bigg)^{(m)}.
  \]
  By \cref{4.2.6} we know that
  \begin{align*}
    \forall m \in \N, \forall x \in (-r, r), & \bigg(y \mapsto \dfrac{r}{r - y}\bigg)^{(m)}                       \\
                                             & = \sum_{n = 0}^\infty r^{-(n + m)} \dfrac{(n + m)!}{n!} x^n        \\
                                             & = \sum_{n = m}^\infty r^{-n} \dfrac{n!}{(n - m)!} x^{n - m}        \\
                                             & = m! \sum_{n = m}^\infty r^{-n} \dfrac{n!}{m! (n - m)!} x^{n - m}.
  \end{align*}
  Thus we have
  \[
    \forall m \in \N, \forall x \in (-r, r), \dfrac{r}{(r - x)^{m + 1}} = \sum_{n = m}^\infty r^{-n} \dfrac{n!}{m! (n - m)!} x^{n - m}.
  \]

  Since
  \begin{align*}
             & \forall m \in \N, \lim_{n \to \infty} \bigg(\dfrac{(n + m)!}{n!}\bigg)^{\dfrac{1}{n}} = 1        &  & \by{ac:4.2.1} \\
    \implies & \forall m \in \N, \lim_{n \to \infty} \bigg(\dfrac{n!}{(n - m)!}\bigg)^{\dfrac{1}{n - m}} = 1                       \\
    \implies & \forall m \in \N, \lim_{n \to \infty} \bigg(\dfrac{n!}{(n - m)!}\bigg)^{\dfrac{1}{n}} = 1                           \\
    \implies & \forall m \in \N, \lim_{n \to \infty} \bigg(\dfrac{n!}{m! (n - m)!}\bigg)^{\dfrac{1}{n}} \leq 1,
  \end{align*}
  we have
  \begin{align*}
             & \forall m \in \N, \limsup_{n \to \infty} \abs{\bigg(\dfrac{n!}{m! (n - m)!}\bigg)^{\dfrac{1}{n}}} \leq 1                          \\
    \implies & \forall m \in \N, \limsup_{n \to \infty} \abs{\bigg(\dfrac{n!}{m! (n - m)!}\bigg)^{\dfrac{1}{n}} \dfrac{x}{r}} < 1                \\
    \implies & \forall m \in \N, \limsup_{n \to \infty} \abs{\bigg(\dfrac{n!}{m! (n - m)!}\bigg)^{\dfrac{1}{n}} (x^n r^{-n})^{\dfrac{1}{n}}} < 1
  \end{align*}
  and by root test
  \[
    \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} x^n r^{-n}
  \]
  is absolutely converges, and so does
  \[
    x^{-m} \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} x^n r^{-n} = \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} x^{n - m} r^{-n}.
  \]
\end{proof}

\begin{ex}\label{ex:4.2.8}
  Let \(E\) be a subset of \(\R\), let \(a\) be an interior point of \(E\), and let \(f : E \to \R\) be a function which is real analytic at \(a\), and has a power series expansion
  \[
    f(x) = \sum_{n = 0}^\infty c_n (x - a)^n
  \]
  at \(a\) which converges on the interval \((a - r, a + r)\).
  Let \((b - s, b + s)\) be any sub-interval of \((a - r, a + r)\) for some \(s > 0\).
  \begin{enumerate}
    \item Prove that \(\abs{a - b} \leq r - s\), so in particular \(\abs{a - b} < r\).
    \item Show that for every \(0 < \varepsilon < r\), there exists a \(C > 0\) such that \(\abs{c_n} \leq C(r - \varepsilon)^{-n}\) for all integers \(n \geq 0\).
    \item Show that the numbers \(d_0, d_1, \dots\) given by the formula
          \[
            d_m \coloneqq \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} (b - a)^{n - m} c_n \text{ for all integers } m \geq 0
          \]
          are well-defined, in the sense that the above series is absolutely convergent.
    \item Show that for every \(0 < \varepsilon < s\) there exists a \(C > 0\) such that
          \[
            \abs{d_m} \leq C(s - \varepsilon)^{-m}
          \]
          for all integers \(m \geq 0\).
    \item Show that the power series \(\sum_{m = 0}^\infty d_m (x - b)^m\) is absolutely convergent for \(x \in (b - s, b + s)\) and converges to \(f(x)\).
    \item Conclude that \(f\) is real analytic at every point in \((a - r, a + r)\).
  \end{enumerate}
\end{ex}

\begin{proof}{(a)}
  \begin{align*}
             & a - r \leq b - s \leq b + s \leq a + r            \\
    \implies & a - b - r \leq -s \leq s \leq a - b + r           \\
    \implies & s - r \leq a - b \leq r - s                       \\
    \implies & \abs{a - b} \leq r - s < r.             & (s > 0)
  \end{align*}
\end{proof}

\begin{proof}{(b)}
  Let \(\varepsilon \in (0, r)\).
  Since
  \begin{align*}
             & 0 < \varepsilon < r                                                                                                     \\
    \implies & 0 < r - \varepsilon < r                                                                                                 \\
    \implies & (a - r + \varepsilon, a + r - \varepsilon) \subseteq (a - r, a + r)                                                     \\
    \implies & \forall x \in (a, a + r) \setminus (a, a + r - \varepsilon), r - \varepsilon \leq x - a < r                             \\
    \implies & \forall n \in \N, \forall x \in (a, a + r) \setminus (a, a + r - \varepsilon), (r - \varepsilon)^n \leq (x - a)^n < r^n
  \end{align*}
  and
  \begin{align*}
             & \forall x \in (a, a + r) \setminus (a, a + r - \varepsilon),                                                                               \\
             & r - \varepsilon < x - a < r \leq \dfrac{1}{\limsup_{n \to \infty} \abs{c_n}^{\dfrac{1}{n}}} &  & \by{4.2.1}                                \\
    \implies & \forall x \in (a, a + r) \setminus (a, a + r - \varepsilon),                                                                               \\
             & \sum_{n = 0}^\infty c_n (x - a)^n \text{ is absolutely convergent}                          &  & \text{(by \cref{4.1.6}(b))}               \\
    \implies & \forall x \in (a, a + r) \setminus (a, a + r - \varepsilon),                                                                               \\
             & \lim_{n \to \infty} c_n (x - a)^n = 0                                                       &  & \text{(by Corollary 7.2.6 in Analysis I)} \\
    \implies & \forall x \in (a, a + r) \setminus (a, a + r - \varepsilon),                                                                               \\
             & \lim_{n \to \infty} \abs{c_n} (x - a)^n = 0                                                                                                \\
    \implies & \lim_{n \to \infty} \abs{c_n} (r - \varepsilon)^n = 0,                                      &  & \text{(by squeeze test)}
  \end{align*}
  we know that
  \begin{align*}
             & \lim_{n \to \infty} \abs{c_n} (r - \varepsilon)^n = 0                      \\
    \implies & \exists N \in \Z^+ : \forall n \geq N, \abs{c_n (r - \varepsilon)^n} < 1   \\
    \implies & \exists N \in \Z^+ : \forall n \geq N, \abs{c_n} < (r - \varepsilon)^{-n}.
  \end{align*}
  Now we fix such \(N\).
  If we define
  \[
    C = 1 + \max\bigg(\abs{c_0} (r - \varepsilon)^0, \dots, \abs{c_{N - 1}} (r - \varepsilon)^{N - 1}\bigg),
  \]
  then we have
  \begin{align*}
             & \begin{dcases}
                 \forall n \geq N, \abs{c_n} < (r - \varepsilon)^{-n} \\
                 \forall 0 \leq n \leq N - 1, \abs{c_n} \leq C
               \end{dcases}                    \\
    \implies & \forall n \geq N, \abs{c_n} \leq C (r - \varepsilon)^{-n}. & (C \geq 1)
  \end{align*}
  Since \(\varepsilon\) is arbitrary, we conclude that
  \[
    \forall \varepsilon \in (0, r), \exists C \in \R^+ : \forall n \in \N, \abs{c_n} \leq C (r - \varepsilon)^{-n}.
  \]
\end{proof}

\begin{proof}{(c)}
  By \cref{ex:4.2.8}(a) we know that \(\abs{b - a} = \abs{a - b} < r\), thus
  \[
    \abs{b - a} < r \implies \exists \varepsilon \in \R^+ : \begin{dcases}
      \abs{b - a} + \varepsilon < r \\
      \varepsilon < r
    \end{dcases} \implies \exists \varepsilon \in \R^+ : \begin{dcases}
      \abs{b - a} < r - \varepsilon \\
      0 < r - \varepsilon
    \end{dcases}
  \]
  Fix such \(\varepsilon\).
  By \cref{ex:4.2.8}(b) we know that
  \[
    \exists C \in \R^+ : \forall n \in \N, \abs{c_n} \leq C (r - \varepsilon)^{-n}.
  \]
  Fix such \(C\).
  Since
  \begin{align*}
     & \forall m \in \N, \dfrac{r - \varepsilon}{(r - \varepsilon - \abs{b - a})^{m + 1}}                                                       \\
     & = \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} \abs{b - a}^{n - m} (r - \varepsilon)^{-n}                &  & \by{4.2.7}                  \\
     & = \dfrac{1}{C} \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} \abs{b - a}^{n - m} C (r - \varepsilon)^{-n}                                  \\
     & \geq \dfrac{1}{C} \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} \abs{b - a}^{n - m} \abs{c_n}                                              \\
     & \geq \dfrac{1}{C} \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} (b - a)^{n - m} c_n                       &  & \text{(by comparison test)} \\
     & = \dfrac{1}{C} d_m,
  \end{align*}
  we know that \(d_m\) are absolutely convergent for all \(m \in \N\).
\end{proof}

\begin{proof}{(d)}
  Let \(\varepsilon \in (0, s)\).
  By \cref{ex:4.2.8}(a) we have
  \begin{align*}
             & \abs{a - b} \leq r - s                                                    \\
    \implies & \abs{a - b} + s \leq r                                                    \\
    \implies & s \leq r                                                                  \\
    \implies & 0 < \varepsilon < r                                                       \\
    \implies & 0 < s - \varepsilon \leq r - \varepsilon                                  \\
    \implies & \forall n \in \N, 0 < (r - \varepsilon)^{-n} \leq (s - \varepsilon)^{-n}.
  \end{align*}
  By \cref{ex:4.2.8}(b) we know that
  \[
    \exists C \in \R^+ : \forall n \in \N, \abs{c_n} \leq C (r - \varepsilon)^{-n} \leq C (s - \varepsilon)^{-n}.
  \]
  Since
  \begin{align*}
             & \abs{a - b} \leq r - s < r - \varepsilon                                      \\
    \implies & \forall m \in \N, \abs{a - b}^{m} \leq (r - s)^m                              \\
    \implies & \forall m \in \N, \forall n \geq m, \abs{a - b}^{n - m} \leq (r - s)^{n - m},
  \end{align*}
  we know that
  \begin{align*}
    \forall m \in \N, \abs{d_m} & = \abs{\sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} (b - a)^{n - m} c_n}                                                          \\
                                & \leq \sum_{n = m}^\infty \abs{\dfrac{n!}{m! (n - m)!} (b - a)^{n - m} c_n}                      &  & \text{(by comparison test)} \\
                                & \leq C \sum_{n = m}^\infty \abs{\dfrac{n!}{m! (n - m)!} (b - a)^{n - m} (r - \varepsilon)^{-n}}                                  \\
                                & = C \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} \abs{b - a}^{n - m} (r - \varepsilon)^{-n}                                       \\
                                & \leq C \sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} (r - s)^{n - m} (r - \varepsilon)^{-n}                                        \\
                                & = C \dfrac{r - \varepsilon}{\big((r - \varepsilon) - (r - s)\big)^{m + 1}}                      &  & \by{4.2.7}                  \\
                                & = C \dfrac{r - \varepsilon}{(s - \varepsilon)^{m + 1}}                                                                           \\
                                & = C \dfrac{r - \varepsilon}{s - \varepsilon} (s - \varepsilon)^{-m}.
  \end{align*}
  Thus by setting \(C' = C \dfrac{r - \varepsilon}{s - \varepsilon}\) we have
  \[
    \forall m \in \N, \abs{d_m} \leq C' (s - \varepsilon)^{-m}.
  \]
  Since \(\varepsilon\) is arbitrary, we conclude that
  \[
    \forall \varepsilon \in (0, s), \exists C \in \R^+ : \forall m \in \N, \abs{d_m} \leq C (s - \varepsilon)^{-m}.
  \]
\end{proof}

\begin{proof}{(e)}
  Let \(x \in (b - s, b + s)\).
  We have
  \begin{align*}
             & x \in (b - s, b + s)                                                                                         \\
    \implies & 0 \leq \abs{x - b} < s                                                                                       \\
    \implies & \exists \varepsilon \in \R^+ : 0 \leq \abs{x - b} < s - \varepsilon                                          \\
    \implies & \exists \varepsilon \in \R^+ : \begin{dcases}
                                                0 \leq \abs{\dfrac{x - b}{s - \varepsilon}} < 1 \\
                                                \exists C \in \R^+ : \forall m \in \N, \abs{d_m} \leq C (s - \varepsilon)^{-m}
                                              \end{dcases} &  & \text{(by \cref{ex:4.2.8}(e))}
  \end{align*}
  Fix such \(\varepsilon\) and \(C\).
  Since
  \begin{align*}
             & \abs{\dfrac{x - b}{s - \varepsilon}} < 1                                                                                                \\
    \implies & \sum_{m = 0}^\infty \abs{\dfrac{x - b}{s - \varepsilon}}^m \text{ is absolutely convergent}, &  & \text{(by Lemma 7.3.3 in Analysis I)}
  \end{align*}
  we have
  \begin{align*}
             & \forall m \in \N, \abs{d_m} \leq C (s - \varepsilon)^{-m}                                                                                                                                                     \\
    \implies & \forall m \in \N, \abs{d_m (x - b)^m} \leq C \abs{\dfrac{x - b}{s - \varepsilon}}^{m}                                                                                                                         \\
    \implies & \sum_{m = 0}^\infty \abs{d_m (x - b)^m} \leq \sum_{m = 0}^\infty C \abs{\dfrac{x - b}{s - \varepsilon}}^{m} = C \sum_{m = 0}^\infty \abs{\dfrac{x - b}{s - \varepsilon}}^{m}                                  \\
    \implies & \sum_{m = 0}^\infty d_m (x - b)^m \text{ is absolutely convergent}.                                                                                                          &  & \text{(by comparison test)}
  \end{align*}
  Since \(\N \times \N\) is countable, we know that \(\N \times S\) is also countable for every non-empty subset \(S\) of \(\N\).
  Thus
  \begin{align*}
     & \sum_{m = 0}^\infty d_m (x - b)^m                                                                                                             \\
     & = \sum_{m = 0}^\infty \bigg(\sum_{n = m}^\infty \dfrac{n!}{m! (n - m)!} (b - a)^{n - m} c_n\bigg) (x - b)^m                                   \\
     & = \sum_{m = 0}^\infty \bigg(\sum_{n = m}^\infty \dfrac{c_n n!}{m! (n - m)!} (b - a)^{n - m} (x - b)^m\bigg)                                   \\
     & = \sum_{n = 0}^\infty \bigg(\sum_{m = 0}^n \dfrac{c_n n!}{m! (n - m)!} (b - a)^{n - m} (x - b)^m\bigg)      &  & \text{(by Fubini's theorem)} \\
     & = \sum_{n = 0}^\infty c_n \bigg(\sum_{m = 0}^n \dfrac{n!}{m! (n - m)!} (b - a)^{n - m} (x - b)^m\bigg)                                        \\
     & = \sum_{n = 0}^\infty c_n (x - a)                                                                           &  & \by{ex:4.2.5}                \\
     & = f(x).
  \end{align*}
  Since \(x\) is arbitrary, we conclude that
  \[
    \forall x \in (b - s, b + s), \sum_{m = 0}^\infty d_m (x - b)^m = f(x) \text{ is absolutely convergent}.
  \]
\end{proof}

\begin{proof}{(f)}
  Let \(b \in (a - r, a + r)\).
  Since
  \begin{align*}
             & \abs{b - a} < r                                     \\
    \implies & \exists s \in \R^+ : \abs{b - a} < r - s            \\
    \implies & \exists s \in \R^+ : s - r < b - a < r - s          \\
    \implies & \exists s \in \R^+ : a - r < b - s < b + s < a + r,
  \end{align*}
  by \cref{ex:4.2.8}(e) we know that \(f\) is real analytic at \(b\).
  Since \(b\) is arbitrary, we conclude that \(f\) is real analytic at \(x\) for all \(x \in (a - r, a + r)\).
\end{proof}
