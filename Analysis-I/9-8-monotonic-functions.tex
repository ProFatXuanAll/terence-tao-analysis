\section{Monotonic functions}\label{i:sec:9.8}

\begin{defn}[Monotonic functions]\label{i:9.8.1}
  Let \(X\) be a subset of \(\R\), and let \(f : X \to \R\) be a function.
  We say that \(f\) is \emph{monotone increasing} iff \(f(y) \geq f(x)\) whenever \(x, y \in X\) and \(y > x\).
  We say that \(f\) is \emph{strictly monotone increasing} iff \(f(y) > f(x)\) whenever \(x, y \in X\) and \(y > x\).
  Similarly, we say \(f\) is \emph{monotone decreasing} iff \(f(y) \leq f(x)\) whenever \(x, y \in X\) and \(y > x\), and \emph{strictly monotone decreasing} iff \(f(y) < f(x)\) whenever \(x, y \in X\) and \(y > x\).
  We say that \(f\) is \emph{monotone} if it is monotone increasing or monotone decreasing, and \emph{strictly monotone} if it is strictly monotone increasing or strictly monotone decreasing.
\end{defn}

\begin{note}
  If a function is strictly monotone on a domain \(X\), it is automatically monotone as well on the same domain \(X\).
  Constant functions, when restricted to an arbitrary domain \(X \subseteq \R\), are both monotone increasing and monotone decreasing, but is not strictly monotone
  (unless \(X\) consists of at most one point).
\end{note}

\begin{note}
  Continuous functions are not necessarily monotone, and monotone functions are not necessarily continuous.
\end{note}

\setcounter{thm}{2}
\begin{prop}\label{i:9.8.3}
  Let \(a < b\) be real numbers, and let \(f : [a, b] \to \R\) be a function which is both continuous and strictly monotone increasing.
  Then \(f\) is a bijection from \([a, b]\) to \([f(a), f(b)]\), and the inverse \(f^{-1} : [f(a), f(b)] \to [a, b]\) is also continuous and strictly monotone increasing.
\end{prop}

\begin{proof}
  We first show that \(f\) is bijective from \([a, b]\) to \([f(a), f(b)]\).
  Since \(a < b\) and \(f\) is strictly monotone increasing, by \cref{i:9.8.1} we know that \(f(a) < f(b)\).
  In particular, \(\forall c \in (a, b)\), we have \(a < c < b\) and \(f(a) < f(c) < f(b)\).
  By \cref{i:9.6.5} this means \(f\) attains its minimum at \(a\) and attains its maximum at \(b\).
  By \cref{i:9.7.4} we know that \(f([a, b]) = [f(a), f(b)]\), thus \(f\) is surjective from \([a, b]\) to \([f(a), f(b)]\).
  Since \(f\) is strictly monotone increasing, by \cref{i:9.8.1} \(x \neq y \implies f(x) \neq f(y)\), thus \(f\) is injective from \([a, b]\) to \([f(a), f(b)]\).
  Since \(f\) is both injective and surjective from \([a, b]\) to \([f(a), f(b)]\), we know that \(f\) is bijective from \([a, b]\) to \([f(a), f(b)]\).

  Next we show that \(f^{-1}\) is continuous.
  Let \(y_0 \in [f(a), f(b)]\).
  By \cref{i:9.1.12} we know that \([f(a), f(b)]\) is closed, so \(y_0\) is an adherent point of \([f(a), f(b)]\).
  Since \(f\) is bijective from \([a, b]\) to \([f(a), f(b)]\), we know that \(\exists!\ x_0 \in [a, b]\) such that \(f(x_0) = y_0\) and thus \(f^{-1}(y_0) = x_0\).
  Again by \cref{i:9.1.12} we know that \([a, b]\) is closed, so \(x_0\) is an adherent point of \([a, b]\).
  To show that \(f^{-1}\) is continuous at \(y_0\), by \cref{i:9.4.1} we need to show that
  \[
    \lim_{y \to y_0 ; y \in [f(a), f(b)]} f^{-1}(y) = f^{-1}(y_0) = x_0.
  \]
  By \cref{i:9.3.6}, it suffice to show that
  \[
    \forall \varepsilon \in \R^+, \exists \delta \in \R^+ : \big(\forall y \in [f(a), f(b)], \abs{y - y_0} < \delta \implies \abs{f^{-1}(y) - x_0} \leq \varepsilon\big).
  \]
  Now fix \(\varepsilon\).
  Let \(x_L = \max(x_0 - \varepsilon, a)\) and \(x_H = \min(x_0 + \varepsilon, b)\).
  Then \(x_L, x_H \in [a, b]\) and \(f(x_L), f(x_H)\) are well-defined.
  Since \(x_L \leq x_0 \leq x_H\) and \(f\) is strictly monotone increasing, we have \(f(x_L) < y_0 < f(x_H)\) and thus \(f(x_L) - y_0 < 0 < f(x_H) - y_0\).
  Let \(\delta = \min\big(y_0 - f(x_L), f(x_H) - y_0\big)\).
  Then we have
  \begin{align*}
             & \forall y \in [f(a), f(b)], \abs{y - y_0} < \delta                                                                 \\
    \implies & -\delta < y - y_0 < \delta                                                                                         \\
    \implies & f(x_L) - y_0 \leq -\delta < y - y_0 < \delta \leq f(x_H) - y_0                                                     \\
    \implies & f(x_L) \leq y \leq f(x_H)                                                                                          \\
    \implies & \exists x \in [x_L, x_H] : \big(f(x) = y\big) \land (x_L \leq x \leq x_H)                        &  & \by{i:9.7.1} \\
    \implies & \exists x \in [x_L, x_H] : \big(f(x) = y\big)                                                                      \\
             & \land (x_0 - \varepsilon \leq x_L \leq x \leq x_H \leq x_0 + \varepsilon)                                          \\
    \implies & \exists x \in [x_L, x_H] : \big(f(x) = y\big) \land (-\varepsilon \leq x - x_0 \leq \varepsilon)                   \\
    \implies & \exists x \in [x_L, x_H] : \big(f(x) = y\big) \land (\abs{x - x_0} \leq \varepsilon)                               \\
    \implies & \exists x \in [x_L, x_H] : \big(f(x) = y\big) \land (\abs{f^{-1}(y) - x_0} \leq \varepsilon).
  \end{align*}
  Since \(\varepsilon\) is arbitrary, \(f^{-1}\) is continuous at \(y_0\).
  Since \(y_0\) is arbitrary, \(f^{-1}\) is continuous on \([f(a), f(b)]\).

  Next we show that \(f^{-1}\) is strictly monotone increasing.
  Let \(y_1, y_2 \in [f(a), f(b)]\) and \(y_1 < y_2\).
  We want to show that \(f^{-1}(y_1) < f^{-1}(y_2)\).
  Suppose for sake of contradiction that \(f^{-1}(y_1) \geq f^{-1}(y_2)\).
  Since \(f\) is strictly monotone increasing, we know that
  \begin{align*}
             & f^{-1}(y_1) \geq f^{-1}(y_2)                                         \\
    \implies & f\big(f^{-1}(y_1)\big) \geq f\big(f^{-1}(y_2)\big) &  & \by{i:9.8.1} \\
    \implies & y_1 \geq y_2.
  \end{align*}
  But this contradict to \(y_1 < y_2\), thus \(f^{-1}(y_1) < f^{-1}(y_2)\).

  Next we show that if the continuity assumption is dropped, then the proposition is false.
  Let \(f : [0, 1] \to \R\) be a function
  \[
    f(x) = \begin{dcases}
      x     & \text{if } x \in [0, 0.5)  \\
      x + 1 & \text{if } x \in [0.5, 1].
    \end{dcases}
  \]
  Then \(f\) is not continuous and \(f([0, 1]) = [0, 0.5) \cup [1.5, 2] \neq [0, 2]\).

  Finally we show that if strict monotonicity is replaced just by monotonicity, then the proposition is false.
  Let \(f : [0, 1] \to \R\) be a function where \(f(x) = 1\).
  Then \(f\) is monotone but not bijective.
\end{proof}

\begin{ac}\label{i:ac:9.8.1}
  Let \(a < b\) be real numbers, and let \(f : [a, b] \to \R\) be a function which is both continuous and strictly monotone decreasing.
  Then \(f\) is a bijection from \([a, b]\) to \([f(b), f(a)]\), and the inverse \(f^{-1} : [f(b), f(a)] \to [a, b]\) is also continuous and strictly monotone decreasing.
\end{ac}

\begin{proof}
  Let \(h : \R \to \R\) be the function \(h(x) = -x\).
  We define a function \(g : [a, b] \to \R\) by setting \(g = -f\).
  Then we have \(g = h \circ f\) and \(f = h \circ g\).
  By \cref{i:9.4.9} we know that \(h\) is continuous on \(\R\), thus by \cref{i:9.4.13} we know that \(g\) is continuous.
  Since \(f\) is strictly monotone decreasing, we have
  \begin{align*}
             & \forall x_1, x_2 \in [a, b], x_1 < x_2                   \\
    \implies & f(x_1) > f(x_2)                        &  & \by{i:9.8.1} \\
    \implies & -f(x_1) < -f(x_2)                                        \\
    \implies & g(x_1) < g(x_2)
  \end{align*}
  and \(g\) is strictly monotone increasing.
  Since \(g\) is monotone increasing and continuous, by \cref{i:9.8.3} we know that \(g : [a, b] \to [g(a), g(b)]\) is bijective and \(g^{-1} : [g(a), g(b)] \to [a, b]\) is continuous and strictly monotone increasing.
  Since \(h\) is bijective, by \cref{i:ex:3.3.7} we know that \(f = h \circ g\) is bijective from \([a, b]\) to \([-g(b), -g(a)] = [f(b), f(a)]\).
  Again by \cref{i:ex:3.3.7} we know that
  \[
    f^{-1} = g^{-1} \circ h^{-1}|_{[f(a), f(b)]}.
  \]
  Since \(h^{-1} = h\) is continuous, by \cref{i:9.4.13} we know that \(f^{-1}\) is continuous.
  Since \(g^{-1}\) is strictly monotone increasing, we have
  \begin{align*}
             & \forall y_1, y_2 \in [f(b), f(a)], y_1 < y_2                                                              \\
    \implies & \exists x_1, x_2 \in [a, b] :                                                                             \\
             & \big(x_1 = f^{-1}(y_1)\big) \land \big(x_2 = f^{-1}(y_2)\big) \land \big(y_1 < y_2\big)                   \\
    \implies & \exists x_1, x_2 \in [a, b] :                                                                             \\
             & \big(g(x_1) = -y_1\big) \land \big(g(x_2) = -y_2\big) \land \big(y_1 < y_2\big)                           \\
    \implies & \exists x_1, x_2 \in [a, b] :                                                                             \\
             & \big(g(x_1) = -y_1\big) \land \big(g(x_2) = -y_2\big) \land \big(g(x_1) > g(x_2)\big)                     \\
    \implies & \exists x_1, x_2 \in [a, b] :                                                                             \\
             & \big(g(x_1) = -y_1\big) \land \big(g(x_2) = -y_2\big)                                                     \\
             & \land \Big(x_1 = g^{-1}\big(g(x_1)\big) > g^{-1}\big(g(x_2)\big) = x_2\Big)             &  & \by{i:9.8.1} \\
    \implies & f^{-1}(y_1) > f^{-1}(y_2)
  \end{align*}
  and thus by \cref{i:9.8.1} \(f^{-1}\) is strictly monotone decreasing.
\end{proof}

\begin{eg}\label{i:9.8.4}
  Let \(n\) be a positive integer and \(R > 0\).
  Since the function \(f(x) \coloneqq x^n\) is strictly increasing on the interval \([0, R]\), we see from \cref{i:9.8.3} that this function is a bijection from \([0, R]\) to \([0, R^n]\), and hence there is an inverse from \([0, R^n]\) to \([0, R]\).
  This can be used to give an alternate means to construct the \(n^{\opTh}\) root \(x^{1 / n}\) of a number \(x \in [0, R]\) than what was done in \cref{i:5.6.5}.
\end{eg}

\exercisesection

\begin{ex}\label{i:ex:9.8.1}
  Explain why the maximum principle remains true if the hypothesis that \(f\) is continuous is replaced with \(f\) being monotone, or with \(f\) being strictly monotone.
\end{ex}

\begin{proof}
  Let \(a < b\) be real numbers, and let \(f : [a, b] \to \R\) be a function.
  Suppose that \(f\) is monotone.
  Then we have
  \begin{align*}
             & \forall c \in [a, b]                                                                         \\
    \implies & a \leq c \leq b                                                            &  & \by{i:9.1.1} \\
    \implies & \big(f(a) \leq f(c) \leq f(b)\big) \lor \big(f(a) \geq f(c) \geq f(b)\big) &  & \by{i:9.8.1} \\
  \end{align*}
  Thus \(f\) attains its maximum at \(f(b)\) and attains its minimum at \(f(a)\) when \(f\) is monotone increasing;
  \(f\) attains its maximum at \(f(a)\) and attains its minimum at \(f(b)\) when \(f\) is monotone decreasing.
  The same argument holds when \(f\) is strictly monotone.
\end{proof}

\begin{ex}\label{i:ex:9.8.2}
  Give an example to show that the intermediate value theorem becomes false if the hypothesis that \(f\) is continuous is replaced with \(f\) being monotone, or with \(f\) being strictly monotone.
\end{ex}

\begin{proof}
  Let \(f : [0, 1] \to \R\) be a function where
  \[
    f(x) = \begin{dcases}
      x     & \text{if } x \in [0, 0.5); \\
      x + 1 & \text{if } x \in [0.5, 1].
    \end{dcases}
  \]
  Then \(f\) is strictly monotone and thus monotone.
  Since \(\forall y \in [0.5, 1.5)\), \(\nexists x \in \N\) such that \(f(x) = y\), the intermediate value theorem (\cref{i:9.7.1}) does not hold.
\end{proof}

\begin{ex}\label{i:ex:9.8.3}
  Let \(a < b\) be real numbers, and let \(f : [a, b] \to \R\) be a function which is both continuous and one-to-one.
  Show that \(f\) is strictly monotone.
\end{ex}

\begin{proof}
  Since \(a < b\) and \(f\) is injective, we cannot have \(f(a) = f(b)\).
  So we have two cases:
  \begin{itemize}
    \item \(f(a) < f(b)\).
          Suppose for sake of contradiction that \(f\) is not strictly monotone.
          Then \(\exists c \in (a, b)\) such that
          \[
            \big(f(c) \leq f(a) < f(b)\big) \lor \big(f(a) < f(b) \leq f(c)\big).
          \]
          Since \(f\) is injective, we have \(\big(f(c) \neq f(a)\big) \land \big(f(c) \neq f(b)\big)\).
          But then we have
          \begin{align*}
                     & \begin{dcases}
                         f(c) < f(a) < f(b) \\
                         f(a) < f(b) < f(c)
                       \end{dcases}                                                        \\
            \implies & \begin{dcases}
                         \exists x_1 \in (c, b) : f(x_1) = f(a) \\
                         \exists x_2 \in (a, c) : f(x_2) = f(b) \\
                       \end{dcases} &  & \by{i:9.7.1}                                    \\
            \implies & \begin{dcases}
                         x_1 = a \\
                         x_2 = b
                       \end{dcases},                            &  & \text{(\(f\) is injective)}
          \end{align*}
          a contradiction.
          Thus \(f\) is strictly monotone.
          Since \(f(a) < f(b)\), by \cref{i:9.8.1} \(f\) is strictly monotone increasing.
    \item \(f(a) > f(b)\).
          Suppose for sake of contradiction that \(f\) is not strictly monotone.
          Then \(\exists c \in (a, b)\) such that
          \[
            \big(f(c) \leq f(b) < f(a)\big) \lor \big(f(b) < f(a) \leq f(c)\big).
          \]
          Since \(f\) is injective, we have \(\big(f(c) \neq f(a)\big) \land \big(f(c) \neq f(b)\big)\).
          But then we have
          \begin{align*}
                     & \begin{dcases}
                         f(c) < f(b) < f(a) \\
                         f(b) < f(a) < f(c)
                       \end{dcases}                                                        \\
            \implies & \begin{dcases}
                         \exists x_1 \in (a, c) : f(x_1) = f(b) \\
                         \exists x_2 \in (c, b) : f(x_2) = f(a) \\
                       \end{dcases} &  & \by{i:9.7.1}                                    \\
            \implies & \begin{dcases}
                         x_1 = b \\
                         x_2 = a
                       \end{dcases},                            &  & \text{(\(f\) is injective)}
          \end{align*}
          a contradiction.
          Thus \(f\) is strictly monotone.
          Since \(f(a) > f(b)\), by \cref{i:9.8.1} \(f\) is strictly monotone decreasing.
  \end{itemize}
  From all cases above we conclude that \(f\) is strictly monotone.
\end{proof}

\begin{ex}\label{i:ex:9.8.4}
  Prove \cref{i:9.8.3}.
  Is the proposition still true if the continuity assumption is dropped, or if strict monotonicity is replaced just by monotonicity?
  How should one modify the proposition to deal with strictly monotone decreasing functions instead of strictly monotone increasing functions?
\end{ex}

\begin{proof}
  See \cref{i:9.8.3} and \cref{i:ac:9.8.1}.
\end{proof}

\begin{ex}\label{i:ex:9.8.5}
  In this exercise we give an example of a function which has a discontinuity at every rational point, but is continuous at every irrational.
  Since the rationals are countable, we can write them as \(\Q = \set{q(0), q(1), q(2), \dots}\), where \(q : \N \to \Q\) is a bijection from \(\N\) to \(\Q\).
  Now define a function \(g : \Q \to \R\) by setting \(g(q(n)) \coloneqq 2^{-n}\) for each natural number \(n\);
  thus \(g\) maps \(q(0)\) to \(1\), \(q(1)\) to \(2^{-1}\), etc.
  Since \(\sum_{n = 0}^\infty 2^{-n}\) is absolutely convergent, we see that \(\sum_{r \in \Q} g(r)\) is also absolutely convergent.
  Now define the function \(f : \R \to \R\) by
  \[
    f(x) \coloneqq \sum_{r \in \Q : r < x} g(r).
  \]
  Since \(\sum_{r \in \Q} g(r)\) is absolutely convergent, we know that \(f(x)\) is well-defined for every real number \(x\).
  \begin{enumerate}
    \item Show that \(f\) is strictly monotone increasing.
    \item Show that for every rational number \(r\), \(f\) is discontinuous at \(r\).
    \item Show that for every irrational number \(x\), \(f\) is continuous at \(x\).
  \end{enumerate}
\end{ex}

\begin{proof}{(a)}
  Let \(a, b \in \R\) and \(a < b\).
  By \cref{i:5.4.14}, \(\exists c \in \Q\) such that \(a < c < b\).
  Then we have
  \begin{align*}
    f(b) & = \sum_{r \in \Q : r < b} g(r)                                                                                                  \\
         & = \sum_{r \in \Q : r < a} g(r) + \sum_{r \in \Q : a \leq r < c} g(r) + \sum_{r \in \Q : c \leq r < b} g(r) &  & \by{i:8.2.6}[c] \\
         & = f(a) + \sum_{r \in \Q : a \leq r < c} g(r) + g(c) + \sum_{r \in \Q : c < r < b} g(r)                     &  & \by{i:8.2.6}[c] \\
         & > f(a).
  \end{align*}
  and by \cref{i:9.8.1} \(f\) is strictly monotone increasing.
\end{proof}

\begin{proof}{(b)}
  Let \(\gamma \in \Q\).
  Since \(q\) is bijective, \(\exists!\ n \in \N\) such that \(q(n) = \gamma\).
  Then \(\forall x \in (\gamma, \infty)\), we have
  \begin{align*}
    f(x) & = \sum_{r \in \Q : r < x} g(r)                                                                               \\
         & = \sum_{r \in \Q : r < \gamma} g(r) + g(\gamma) + \sum_{r \in \Q : \gamma < r < x} g(r) &  & \by{i:8.2.6}[c] \\
         & = f(\gamma) + g(\gamma) + \sum_{r \in \Q : \gamma < r < x} g(r)                                              \\
         & > f(\gamma) + g(\gamma)                                                                                      \\
         & = f(\gamma) + 2^{-n}.
  \end{align*}
  But this means
  \begin{align*}
             & \forall x \in (\gamma, \infty), f(x) - f(\gamma) > 2^{-n}                            \\
    \implies & \forall x \in (\gamma, \infty), \abs{f(x) - f(\gamma)} > 2^{-n}                      \\
    \implies & f(\gamma^+) \text{ does not exist}                              &  & \by{i:9.5.1}    \\
    \implies & f \text{ is not continuous at } \gamma.                         &  & \by{i:ac:9.5.1}
  \end{align*}
  Since \(\gamma\) is arbitrary, we conclude that \(f\) is discontinuous at each \(\gamma \in \Q\).
\end{proof}

\begin{proof}{(c)}
  Let \(n \in \N\), let \(E_n\) be a set where
  \[
    E_n = \set{r \in \Q : g(r) \geq 2^{-n}},
  \]
  and let \(f_n : \R \to \R\) be a function
  \[
    f_n(x) = \sum_{r \in E_n : r < x} g(r) = \sum_{r \in \Q : r < x, g(r) \geq 2^{-n}} g(r).
  \]
  Since \(q\) is bijective, there are at most \(n + 1\) rationals satisfying \((r \in \Q) \land \big(g(r) \geq 2^{-n}\big)\), thus \(E_n\) is finite and non-empty.
  Since \(\R \setminus \Q \subseteq \R\), by \cref{i:9.1.11} \(\forall x_0 \in \R \setminus \Q\), \(x_0\) is an adherent point of \(\R \setminus \Q\).
  Let \(\varepsilon \in \R^+\) and let \(\delta = \min\set{\abs{r - x_0} : r \in E_n}\).
  Since \(x_0 \notin \Q\), we have \(\delta > 0\).
  Then we have
  \begin{align*}
             & \forall x \in \R \setminus \Q, \abs{x - x_0} < \delta               \\
    \implies & \forall r \in E_n, \abs{x - x_0} < \delta \leq \abs{r - x_0}        \\
    \implies & \forall r \in E_n, \abs{x - x_0} < \abs{r - x_0}                    \\
    \implies & \forall r \in E_n, -\abs{r - x_0} < x - x_0 < \abs{r - x_0}         \\
    \implies & \forall r \in E_n, \begin{dcases}
                                    r - x_0 < x - x_0 < x_0 - r & \text{if } r < x_0 \\
                                    x_0 - r < x - x_0 < r - x_0 & \text{if } r > x_0
                                  \end{dcases} \\
    \implies & \forall r \in E_n, \begin{dcases}
                                    r < x & \text{if } r < x_0 \\
                                    r > x & \text{if } r > x_0
                                  \end{dcases}                       \\
    \implies & \set{r \in E_n : r < x} = \set{r \in E_n : r < x_0}                 \\
    \implies & f_n(x) = f_n(x_0)                                                   \\
    \implies & 0 = \abs{f_n(x) - f_n(x_0)} < \varepsilon.
  \end{align*}
  Since \(\varepsilon\) is arbitrary, by \cref{i:9.3.6} we have \(\lim_{x \to x_0 ; x \in \R \setminus \Q} f_n(x) = f_n(x_0)\), and by \cref{i:9.4.1} \(f_n\) is continuous at \(x_0\).

  Now we show that \(f\) is continuous at \(x_0\).
  We have
  \begin{align*}
     & \forall x \in \R \setminus \Q, \abs{f(x) - f_n(x)}                                                         \\
     & = \abs{\sum_{r \in \Q : r < x} g(r) - \sum_{r \in E_n : r < x} g(r)}                                       \\
     & = \abs{\sum_{r \in \Q : r < x} g(r) - \sum_{r \in \Q : r < x, g(r) \geq 2^{-n}} g(r)}                      \\
     & = \abs{\sum_{r \in \Q : r < x, g(r) < 2^{-n}} g(r)}                                   &  & \by{i:8.2.6}[c] \\
     & = \sum_{r \in \Q : r < x, g(r) < 2^{-n}} g(r)                                                              \\
     & = \sum_{r \in \Q : r < x, g(r) \leq 2^{-(n + 1)}} g(r)                                                     \\
     & \leq \sum_{r \in \Q : g(r) \leq 2^{-(n + 1)}} g(r)                                                         \\
     & \leq \sum_{k = n + 1}^\infty 2^{-k}                                                                        \\
     & = 2^{-(n + 1)} \bigg(\sum_{k = 0}^\infty 2^{-k}\bigg)                                                      \\
     & = 2^{-n}.                                                                             &  & \by{i:7.3.3}
  \end{align*}
  By \cref{i:5.4.14}, \(\forall \varepsilon \in \R^+\), \(\exists n \in \N\) such that \(2^{-n} < \varepsilon / 2\).
  From the proof above we also have
  \[
    \forall x \in \R \setminus \Q, \abs{x - x_0} < \delta \implies f_n(x) = f_n(x_0) \\
  \]
  Combine the results above we have
  \begin{align*}
     & \abs{f(x) - f(x_0)}                              \\
     & = \abs{f(x) - f_n(x) + f_n(x) - f(x_0)}          \\
     & \leq \abs{f(x) - f_n(x)} + \abs{f_n(x) - f(x_0)} \\
     & = \abs{f(x) - f_n(x)} + \abs{f_n(x_0) - f(x_0)}  \\
     & \leq 2^{-n} + 2^{-n}                             \\
     & < \varepsilon / 2 + \varepsilon / 2              \\
     & = \varepsilon.
  \end{align*}
  Since \(\varepsilon\) is arbitrary, by \cref{i:9.3.6} we have \(\lim_{x \to x_0 ; x \in \R \setminus \Q} f(x) = f(x_0)\), and by \cref{i:9.4.1} \(f\) is continuous at \(x_0\).
\end{proof}
