\section{Inverse functions and derivatives}\label{sec 10.4}

\begin{lemma}\label{10.4.1}
    Let \(f : X \to Y\) be an invertible function, with inverse \(f^{-1} : Y \to X\).
    Suppose that \(x_0 \in X\) and \(y_0 \in Y\) are such that \(y_0 = f(x_0)\)
    (which also implies that \(x_0 = f^{-1}(y_0)\)).
    If \(f\) is differentiable at \(x_0\), and \(f^{-1}\) is differentiable at \(y_0\), then
    \[
        (f^{-1})'(y_0) = \frac{1}{f'(x_0)}.
    \]
\end{lemma}

\begin{proof}
    From the chain rule (Theorem \ref{10.1.15}) we have
    \[
        (f^{-1} \circ f)'(x_0) = (f^{-1})'(y_0) f'(x_0).
    \]
    But \(f^{-1} \circ f\) is the identity function on \(X\), and hence by Theorem \ref{10.1.13}(b) \((f^{-1} \circ f)'(x_0) = 1\).
    The claim follows.
\end{proof}

\begin{note}
    As a particular corollary of Lemma \ref{10.4.1}, we see that if \(f\) is differentiable at \(x_0\) with \(f'(x_0) = 0\), then \(f^{-1}\) cannot be differentiable at \(y_0 = f(x_0)\), since \(1 / f'(x_0)\) is undefined in that case.
\end{note}

\begin{note}
    If one writes \(y = f(x)\), so that \(x = f^{-1}(y)\), then one can write the conclusion of Lemma \ref{10.4.1} in the more appealing form \(dx / dy = 1 / (dy / dx)\).
    However, as mentioned before, this way of writing things, while very convenient and easy to remember, can be misleading and cause errors if applied too carelessly (especially when one begins to work in the calculus of several variables).
\end{note}

\begin{note}
    Lemma \ref{10.4.1} seems to answer the question of how to differentiate the inverse of a function, however it has one significant drawback:
    the lemma only works if one assumes a \emph{priori} that \(f^{-1}\) is differentiable.
    Thus, if one does not already know that \(f^{-1}\) is differentiable, one cannot use Lemma \ref{10.4.1} to compute the derivative of \(f^{-1}\).
\end{note}

\begin{theorem}[Inverse function theorem]\label{10.4.2}
    Let \(f : X \to Y\) be an invertible function, with inverse \(f^{-1} : Y \to X\).
    Suppose that \(x_0 \in X\) and \(y_0 \in Y\) are such that \(f(x_0) = y_0\).
    If \(f\) is differentiable at \(x_0\), \(f^{-1}\) is continuous at \(y_0\), and \(f'(x_0 ) \neq 0\), then \(f^{-1}\) is differentiable at \(y_0\) and
    \[
        (f^{-1})'(y_0) = \frac{1}{f'(x_0)}.
    \]
\end{theorem}

\begin{proof}
    We have to show that
    \[
        \lim_{y \to y_0 ; y \in Y \setminus \{y_0\}} \frac{f^{-1}(y) - f^{-1}(y_0)}{y - y_0} = \frac{1}{f'(x_0)}.
    \]
    By Proposition \ref{9.3.9}, it suffices to show that
    \[
        \lim_{n \to \infty} \frac{f^{-1}(y_n) - f^{-1}(y_0)}{y_n - y_0} = \frac{1}{f'(x_0)}
    \]
    for any sequence \((y_n)_{n = 1}^\infty\) of elements in \(Y \setminus \{y_0\}\) which converge to \(y_0\).

    To prove this, we set \(x_n \coloneqq f^{-1}(y_n)\).
    Then \((x_n)_{n = 1}^\infty\) is a sequence of elements in \(X \setminus \{x_0\}\).
    (Note that \(f^{-1}\) is a bijection)
    Since \(f^{-1}\) is continuous by assumption, we know that \(x_n = f^{-1}(y_n)\) converges to \(f^{-1}(y_0) = x_0\) as \(n \to \infty\).
    Thus, since \(f\) is differentiable at \(x_0\), we have (by Proposition \ref{9.3.9} again)
    \[
        \lim_{n \to \infty} \frac{f(x_n) - f(x_0)}{x_n - x_0} = f'(x_0).
    \]
    But since \(x_n \neq x_0\) and \(f\) is a bijection, the fraction \(\frac{f(x_n) - f(x_0)}{x_n - x_0}\) is non-zero.
    Also, by hypothesis \(f(x_0)\) is non-zero.
    So by limit laws
    \[
        \lim_{n \to \infty} \frac{x_n - x_0}{f(x_n) - f(x_0)} = \frac{1}{f'(x_0)}.
    \]
    But since \(x_n = f^{-1}(y_n)\) and \(x_0 = f^{-1}(y_0)\), we thus have
    \[
        \lim_{n \to \infty} \frac{f^{-1}(y_n) - f^{-1}(y_0)}{y_n - y_0} = \frac{1}{f'(x_0)}.
    \]
    as desired.
\end{proof}

\exercisesection

\begin{exercise}\label{ex 10.4.1}
    Let \(n \geq 1\) be a natural number, and let \(g : (0, \infty) \to (0, \infty)\) be the function \(g(x) \coloneqq x^{1 / n}\).
    \begin{enumerate}
        \item Show that \(g\) is continuous on \((0, \infty)\).
        \item Show that \(g\) is differentiable on \((0, \infty)\), and that \(g'(x) = \frac{1}{n} x^{\frac{1}{n} - 1}\) for all \(x \in (0, \infty)\).
    \end{enumerate}
\end{exercise}

\begin{proof}
    We first show that \(g\) is continuous on \((0, \infty)\).
    Let \(f : (0, \infty) \to (0, \infty)\) be a function where \(f(x) = x^n\).
    Then \(g \circ f : (0, \infty) \to (0, \infty) = x\) and thus \(g = f^{-1}\).
    By Exercise \ref{ex 10.1.5} we know that \(x^n\) is differentiable on \((0, \infty)\), thus by Corollary \ref{10.1.12} \(f\) is continuous on \((0, \infty)\).
    By Example \ref{9.8.4} \(f\) is strictly monotone increasing.
    Then by Proposition \ref{9.8.3} we know that \(g\) is also continuous and strictly monotone increasing.

    Now we show that \(g\) is differentiable on \((0, \infty)\), and that \(g'(x) = \frac{1}{n} x^{\frac{1}{n} - 1}\) for all \(x \in (0, \infty)\).
    Since \(g\) is continuous, \(g = f^{-1}\), and \(f(x) \neq 0\) for every \(x \in (0, \infty)\), we have
    \begin{align*}
                 & g(x) = f(x^{1 / n})                                                                                               \\
        \implies & g'(x) = \frac{1}{f'(x^{1 / n})}                                            & \text{(by Theorem \ref{10.4.2})}     \\
        \implies & g'(x) = \frac{1}{n (x^{1 / n})^{n - 1}} = \frac{1}{n} x^{\frac{1}{n} - 1}. & \text{(by Exercise \ref{ex 10.1.5})}
    \end{align*}
\end{proof}

\begin{exercise}\label{ex 10.4.2}
    Let \(q\) be a rational number, and let \(f : (0, \infty) \to \mathbf{R}\) be the function \(f(x) = x^q\).
    \begin{enumerate}
        \item Show that \(f\) is differentiable on \((0, \infty)\) and that \(f'(x) = q x^{q - 1}\).
        \item Show that \(\lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{x^q - 1}{x - 1} = q\) for every rational number \(q\).
    \end{enumerate}
\end{exercise}

\begin{proof}
    We first show that \(f\) is differentiable on \((0, \infty)\) and that \(f'(x) = q x^{q - 1}\).
    Let \(q = a / b\) where \(a, b \in \mathbf{Z}\) and \(b > 0\).
    Then we have
    \[
        x^q = x^{a / b} = (x^a)^{1 / b}.
    \]
    By Exercise \ref{ex 10.1.5} and Exercise \ref{ex 10.1.6} we know that \(x^a\) is differentiable on \((0, \infty)\).
    By Exercise \ref{ex 10.4.1}(b) we know that \(x^{1 / b}\) is differentiable on \((0, \infty)\).
    Thus by chain rule (Theorem \ref{10.1.15}) we know that \(x^q = x^{a / b}\) is differentiable and
    \begin{align*}
        (x^q)' & = (x^{a / b})'                                                                            \\
               & = (\frac{1}{b} (x^a)^{\frac{1}{b} - 1}) (a x^{a - 1}) & \text{(by Theorem \ref{10.1.15})} \\
               & = \frac{a}{b} x^{\frac{a}{b} - 1}                                                         \\
               & = q x^{q - 1}.
    \end{align*}

    Now we show that \(\lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{x^q - 1}{x - 1} = q\) for every \(q \in \mathbf{Q}\).
    Since \(x^q\) is differentiable on \((0, \infty)\), we know that \(x^q\) is differentiable at \(1\).
    Thus by Definition \ref{10.1.1} we have
    \[
        \lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{x^q - 1}{x - 1} = f'(1) = q \cdot 1^{q - 1} = q.
    \]
\end{proof}

\begin{exercise}\label{ex 10.4.3}
    Let \(\alpha\) be a real number, and let \(f : (0, \infty) \to \mathbf{R}\) be the function \(f(x) = x^{\alpha}\).
    \begin{enumerate}
        \item Show that \(\lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{f(x) - f(1)}{x - 1} = \alpha\).
        \item Show that \(f\) is differentiable on \((0, \infty)\) and that \(f'(x) = \alpha x^{\alpha - 1}\).
    \end{enumerate}
\end{exercise}

\begin{proof}
    We first show that \(\lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{f(x) - f(1)}{x - 1} = \alpha\).
    By Definition \ref{6.7.2} we know that \(1^{\alpha} = 1\).
    Let \(\varepsilon \in \mathbf{R}^+\).
    Then we have
    \begin{align*}
                 & \alpha - \varepsilon < \alpha < \alpha + \varepsilon                                                                                                                                          \\
        \implies & \exists\ q_1, q_2 \in \mathbf{Q} : \alpha - \varepsilon < q_1 < \alpha < q_2 < \alpha + \varepsilon                                             & \text{(by Proposition \ref{5.4.14})}        \\
        \implies & \forall\ x \in (0, \infty) \setminus \{1\},                                                                                                                                                   \\
                 & \frac{x^{q_1} - 1}{x - 1} < \frac{x^{\alpha} - 1}{x - 1} < \frac{x^{q_2} - 1}{x - 1}                                                            & \text{(by Proposition \ref{6.7.3})}         \\
        \implies & q_1 = \lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{x^{q_1} - 1}{x - 1}                                                              & \text{(by Exercise \ref{ex 10.4.2}(b))}     \\
                 & \leq \lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{x^{\alpha} - 1}{x - 1}                                                            & \text{(by Proposition \ref{9.3.14})}        \\
                 & \leq \lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{x^{q_2} - 1}{x - 1} = q_2                                                         & \text{(by Exercise \ref{ex 10.4.2}(b))}     \\
        \implies & \alpha - \varepsilon < q_1 \leq \lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{x^{\alpha} - 1}{x - 1} \leq q_2 < \alpha + \varepsilon                                               \\
        \implies & \abs*{\lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{x^{\alpha} - 1}{x - 1} - \alpha} \leq \varepsilon                                                                              \\
        \implies & \lim_{x \to 1 ; x \in (0, \infty) \setminus \{1\}} \frac{x^{\alpha} - 1}{x - 1} = \alpha.                                                       & \text{(Since \(\varepsilon\) is arbitrary)}
    \end{align*}

    Now we show that \(f\) is differentiable on \((0, \infty)\) and that \(f'(x) = \alpha x^{\alpha - 1}\).
    From proof above we know that \(f\) is differentiable at \(1\).
    Let \(x_0 \in (0, \infty)\).
    By Theorem \ref{10.1.13}(b)(e) we know that \(g(x) = x / x_0\) is differentiable at \(x_0\).
    Then by chain rule (Theorem \ref{10.1.15}) we know that \(f \circ g\) is differentiable at \(x_0\).
    Thus we have
    \begin{align*}
        (f \circ g)'(x_0) & = f'(1) g'(x_0)                                                                                                                       & \text{(by Theorem \ref{10.1.15})}       \\
                          & = \frac{\alpha}{x_0}                                                                                                                  & \text{(by Theorem \ref{10.1.13}(b)(e))} \\
                          & = \lim_{x \to x_0 ; x \in (0, \infty) \setminus \{x_0\}} \frac{(f \circ g)(x) - (f \circ g)(x_0)}{x - x_0}                            & \text{(by Definition \ref{10.1.1})}     \\
                          & = \lim_{x \to x_0 ; x \in (0, \infty) \setminus \{x_0\}} \frac{(x / x_0)^{\alpha} - (x_0 / x_0)^{\alpha}}{x - x_0}                                                              \\
                          & = \frac{1}{x_0^{\alpha}} \bigg(\lim_{x \to x_0 ; x \in (0, \infty) \setminus \{x_0\}} \frac{x^{\alpha} - x_0^{\alpha}}{x - x_0}\bigg) & \text{(by Theorem \ref{10.1.13}(e))}
    \end{align*}
    and
    \[
        \lim_{x \to x_0 ; x \in (0, \infty) \setminus \{x_0\}} \frac{x^{\alpha} - x_0^{\alpha}}{x - x_0} = \alpha x_0^{\alpha - 1}.
    \]
    By Definition \ref{10.1.1} \(f\) is differentiable at \(x_0\), and since \(x_0\) is arbitrary we know that \(f\) is differentiable on \((0, \infty)\).
\end{proof}