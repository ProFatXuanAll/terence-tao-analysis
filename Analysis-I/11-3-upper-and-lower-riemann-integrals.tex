\section{Upper and lower Riemann integrals}\label{sec:11.3}

\begin{defn}[Majorization of functions]\label{11.3.1}
  Let \(f : I \to \R\) and \(g : I \to \R\).
  We say that \(g\) \emph{majorizes} \(f\) on \(I\) if we have \(g(x) \geq f(x)\) for all \(x \in I\), and that \(g\) \emph{minorizes} \(f\) on \(I\) if \(g(x) \leq f(x)\) for all \(x \in I\).
\end{defn}

\begin{defn}[Upper and lower Riemann integrals]\label{11.3.2}
  Let \(f : I \to \R\) be a bounded function defined on a bounded interval \(I\).
  We define the \emph{upper Riemann integral} \(\overline{\int}_I f\) by the formula
  \[
    \overline{\int}_I f \coloneqq \inf\bigg\{p.c. \int_I g : g \text{ is a piecewise constant function on \(I\) which majorizes } f\bigg\}
  \]
  and the \emph{lower Riemann integral} \(\underline{\int}_I f\) by the formula
  \[
    \underline{\int}_I f \coloneqq \sup\bigg\{p.c. \int_I g : g \text{ is a piecewise constant function on \(I\) which minorizes } f\bigg\}.
  \]
\end{defn}

\begin{lem}\label{11.3.3}
  Let \(f : I \to \R\) be a function on a bounded interval \(I\) which is bounded by some real number \(M\), i.e., \(-M \leq f(x) \leq M\) for all \(x \in I\).
  Then we have
  \[
    -M \abs{I} \leq \underline{\int}_I f \leq \overline{\int}_I f \leq M \abs{I}.
  \]
  in particular, both the lower and upper Riemann integrals are real numbers (i.e., they are not infinite).
\end{lem}

\begin{proof}
  The function \(g : I \to \R\) defined by \(g(x) = M\) is constant, hence piecewise constant, and majorizes \(f\);
  thus \(\overline{\int}_I f \leq p.c. \int_I g = M \abs{I}\) by definition of the upper Riemann integral.
  A similar argument gives \(-M \abs{I} \leq \underline{\int}_I f\).
  Finally, we have to show that \(\underline{\int}_I f \leq \overline{\int}_I f\).
  Let \(g\) be any piecewise constant function majorizing \(f\), and let \(h\) be any piecewise constant function minorizing \(f\).
  Then \(g\) majorizes \(h\), and hence \(p.c. \int_I h \leq p.c. \int_I g\).
  Taking suprema in \(h\), we obtain that \(\underline{\int}_I f \leq p.c. \int_I g\).
  Taking infima in \(g\), we thus obtain \(\underline{\int}_I f \leq \overline{\int}_I f\), as desired.
\end{proof}

\begin{defn}[Riemann integral]\label{11.3.4}
  Let \(f : I \to \R\) be a bounded function on a bounded interval \(I\).
  If \(\underline{\int}_I f = \overline{\int}_I f\), then we say that \(f\) is \emph{Riemann integrable on \(I\)} and define
  \[
    \int_I f \coloneqq \underline{\int}_I f = \overline{\int}_I f.
  \]
  If the upper and lower Riemann integrals are unequal, we say that \(f\) is not Riemann integrable.
\end{defn}

\begin{rmk}\label{11.3.5}
  Compare this definition to the relationship between the \(\limsup\), \(liminf\), and limit of a sequence \(a_n\) that was established in \cref{6.4.12}(f);
  the \(\limsup\) is always greater than or equal to the \(\liminf\), but they are only equal when the sequence converges, and in this case they are both equal to the limit of the sequence.
  The definition given above may differ from the definition you may have encountered in your calculus courses, based on Riemann sums.
  However, the two definitions turn out to be equivalent.
\end{rmk}

\begin{rmk}\label{11.3.6}
  Note that we do not consider unbounded functions to be Riemann integrable;
  an integral involving such functions is known as an \emph{improper integral}.
  It is possible to still evaluate such integrals using more sophisticated integration methods (such as the Lebesgue integral).
\end{rmk}

\begin{lem}\label{11.3.7}
  Let \(f : I \to \R\) be a piecewise constant function on a bounded interval \(I\).
  Then \(f\) is Riemann integrable, and \(\int_I f = p.c. \int_I f\).
\end{lem}

\begin{proof}
  Since \(f(x) \leq f(x)\) for every \(x \in I\), by \cref{11.3.2} we have
  \[
    \overline{\int}_I f \leq p.c. \int_I f
  \]
  and
  \[
    p.c. \int_I f \leq \underline{\int}_I f.
  \]
  By \cref{11.3.3} we know that
  \[
    p.c. \int_I f \leq \underline{\int}_I f \leq \overline{\int}_I f \leq p.c. \int_I f.
  \]
  Thus by \cref{11.3.4} we have
  \[
    \int_I f = \underline{\int}_I f = \overline{\int}_I f = p.c. \int_I f.
  \]
\end{proof}

\begin{rmk}\label{11.3.8}
  Because of \cref{11.3.7}, we will not refer to the piecewise constant integral \(p.c. \int_I\) again, and just use the Riemann integral \(\int_I\) throughout
  (until this integral is itself superceded by the Lebesgue integral).
  We observe one special case of \cref{11.3.7}:
  if \(I\) is a point or the empty set, then \(\int_I f = 0\) for all functions \(f : I \to \R\).
  (Note that all such functions are automatically constant.)
\end{rmk}

\begin{defn}[Riemann sums]\label{11.3.9}
  Let \(f : I \to \R\) be a bounded function on a bounded interval \(I\), and let \(\mathbf{P}\) be a partition of \(I\).
  We define the \emph{upper Riemann sum} \(U(f, \mathbf{P})\) and the \emph{lower Riemann sum} \(L(f, \mathbf{P})\) by
  \[
    U(f, \mathbf{P}) \coloneqq \sum_{J \in \mathbf{P} : J \neq \emptyset} \big(\sup_{x \in J} f(x)\big) \abs{J}
  \]
  and
  \[
    L(f, \mathbf{P}) \coloneqq \sum_{J \in \mathbf{P} : J \neq \emptyset} \big(\inf_{x \in J} f(x)\big) \abs{J}.
  \]
\end{defn}

\begin{rmk}\label{11.3.10}
  The restriction \(J \neq \emptyset\) is required because the quantities \(\inf_{x \in J} f(x)\) and \(\sup_{x \in J} f(x)\) are infinite (or negative infinite) if \(J\) is empty.
\end{rmk}

\begin{lem}\label{11.3.11}
  Let \(f : I \to \R\) be a bounded function on a bounded interval \(I\), and let \(g\) be a function which majorizes \(f\) and which is piecewise constant with respect to some partition \(\mathbf{P}\) of \(I\).
  Then
  \[
    p.c. \int_I g \geq U(f, \mathbf{P}).
  \]
  Similarly, if \(h\) is a function which minorizes \(f\) and is piecewise constant with respect to \(\mathbf{P}\), then
  \[
    p.c. \int_I h \leq L(f, \mathbf{P}).
  \]
\end{lem}

\begin{proof}
  Since \(g\) majorizes \(f\) and \(h\) minorizes \(f\), by \cref{11.3.1} we have \(h(x) \leq f(x) \leq g(x)\) for every \(x \in I\).
  Since \(\mathbf{P}\) is a partition of \(I\), by \cref{11.1.10} for every \(J \in \mathbf{P}\), we have \(h(x) \leq f(x) \leq g(x)\) for all \(x \in J\).
  In particular, when \(J \neq \emptyset\) we have
  \[
    h(x) \leq \inf_{x \in J} f(x) \leq f(x) \leq \sup_{x \in J} f(x) \leq g(x)
  \]
  for every \(x \in J\).
  Let \(c_{g|_J}, c_{h|_J}\) be constant values of \(g|_J, h|_J\), respectively.
  Then we have
  \begin{align*}
    U(f, \mathbf{P}) & = \sum_{J \in \mathbf{P} : J \neq \emptyset} \big(\sup_{x \in J} f(x)\big) \abs{J} & \text{(by \cref{11.3.9})}       \\
                     & \leq \sum_{J \in \mathbf{P} : J \neq \emptyset} c_{g|_J} \abs{J}                   & \text{(by \cref{7.1.11}(h))}    \\
                     & = \sum_{J \in \mathbf{P}} c_{g|_J} \abs{J}                                         & \text{(by \cref{7.1.11}(a)(e))} \\
                     & = p.c. \int_{[\mathbf{P}]} g                                                       & \text{(by \cref{11.2.9})}       \\
                     & = p.c. \int_I g                                                                    & \text{(by \cref{11.2.14})}
  \end{align*}
  and
  \begin{align*}
    L(f, \mathbf{P}) & = \sum_{J \in \mathbf{P} : J \neq \emptyset} \big(\inf_{x \in J} f(x)\big) \abs{J} & \text{(by \cref{11.3.9})}       \\
                     & \geq \sum_{J \in \mathbf{P} : J \neq \emptyset} c_{h|_J} \abs{J}                   & \text{(by \cref{7.1.11}(h))}    \\
                     & = \sum_{J \in \mathbf{P}} c_{h|_J} \abs{J}                                         & \text{(by \cref{7.1.11}(a)(e))} \\
                     & = p.c. \int_{[\mathbf{P}]} h                                                       & \text{(by \cref{11.2.9})}       \\
                     & = p.c. \int_I h.                                                                   & \text{(by \cref{11.2.14})}
  \end{align*}
\end{proof}

\begin{prop}\label{11.3.12}
  Let \(f : I \to \R\) be a bounded function on a bounded interval \(I\).
  Then
  \[
    \overline{\int}_I f = \inf\{U(f, \mathbf{P}) : \mathbf{P} \text{ is a partition of } I\}
  \]
  and
  \[
    \underline{\int}_I f = \sup\{L(f, \mathbf{P}) : \mathbf{P} \text{ is a partition of } I\}.
  \]
\end{prop}

\begin{proof}
  Let \(g\) be a function which majorizes \(f\) and which is piecewise constant with respect to some partition \(\mathbf{P}_g\) of \(I\).
  Let \(h\) be a function which minorizes \(f\) and which is piecewise constant with respect to some partition \(\mathbf{P}_h\) of \(I\).
  Both functions are well defined since \(f\) is bounded function on a bounded interval \(I\).
  By \cref{11.3.11} we have
  \[
    \inf\big\{U(f, \mathbf{P}) : \mathbf{P} \text{ is a partition of } I\big\} \leq U(f, \mathbf{P}_g) \leq p.c. \int_I g
  \]
  and
  \[
    \sup\big\{L(f, \mathbf{P}) : \mathbf{P} \text{ is a partition of } I\big\} \geq L(f, \mathbf{P}_h) \geq p.c. \int_I h.
  \]
  Since \(g, h\) are arbitrary, by \cref{11.3.2} we have
  \[
    \inf\big\{U(f, \mathbf{P}) : \mathbf{P} \text{ is a partition of } I\big\} \leq \overline{\int}_I f
  \]
  and
  \[
    \sup\big\{L(f, \mathbf{P}) : \mathbf{P} \text{ is a partition of } I\big\} \geq \underline{\int}_I f.
  \]

  Let \(\mathbf{P}\) be a partition of \(I\).
  Let \(G : I \to \R\) be a function where \(G(x) = \sup_{x \in J} f(x)\) for all \(J \in \mathbf{P}\).
  Let \(H : I \to \R\) be a function where \(H(x) = \inf_{x \in J} f(x)\) for all \(J \in \mathbf{P}\).
  By \cref{11.2.3} we know that \(G, H\) are piecewise constant functions with respect to \(\mathbf{P}\).
  Thus we have
  \begin{align*}
    U(f, \mathbf{P}) & = \sum_{J \in \mathbf{P} : J \neq \emptyset} \big(\sup_{x \in J} f(x)\big) \abs{J} & \text{(by \cref{11.3.9})}       \\
                     & = \sum_{J \in \mathbf{P}} \big(\sup_{x \in J} f(x)\big) \abs{J}                    & \text{(by \cref{7.1.11}(a)(e))} \\
                     & = p.c. \int_{[\mathbf{P}]} G                                                       & \text{(by \cref{11.2.9})}       \\
                     & = p.c. \int_I G                                                                    & \text{(by \cref{11.2.14})}
  \end{align*}
  and
  \begin{align*}
    L(f, \mathbf{P}) & = \sum_{J \in \mathbf{P} : J \neq \emptyset} \big(\inf_{x \in J} f(x)\big) \abs{J} & \text{(by \cref{11.3.9})}       \\
                     & = \sum_{J \in \mathbf{P}} \big(\inf_{x \in J} f(x)\big) \abs{J}                    & \text{(by \cref{7.1.11}(a)(e))} \\
                     & = p.c. \int_{[\mathbf{P}]} H                                                       & \text{(by \cref{11.2.9})}       \\
                     & = p.c. \int_I H.                                                                   & \text{(by \cref{11.2.14})}
  \end{align*}
  By \cref{11.3.2} we have
  \[
    \overline{\int}_I f \leq p.c. \int_I G = U(f, \mathbf{P})
  \]
  and
  \[
    \underline{\int}_I f \geq p.c. \int_I H = L(f, \mathbf{P}).
  \]
  Since \(\mathbf{P}\) is arbitrary, we have
  \[
    \overline{\int}_I f \leq \inf\big\{U(f, \mathbf{P}) : \mathbf{P} \text{ is a partition of } I\big\} \leq U(f, \mathbf{P})
  \]
  and
  \[
    \underline{\int}_I f \geq \sup\big\{L(f, \mathbf{P}) : \mathbf{P} \text{ is a partition of } I\big\} \leq L(f, \mathbf{P}).
  \]
  Combine all results above we have
  \[
    \overline{\int}_I f = \inf\big\{U(f, \mathbf{P}) : \mathbf{P} \text{ is a partition of } I\big\}
  \]
  and
  \[
    \underline{\int}_I f = \sup\big\{L(f, \mathbf{P}) : \mathbf{P} \text{ is a partition of } I\big\}.
  \]
\end{proof}

\exercisesection

\begin{ex}\label{ex:11.3.1}
  Let \(f : I \to \R\), \(g : I \to \R\), and \(h : I \to \R\) be functions.
  Show that if \(f\) majorizes \(g\) and \(g\) majorizes \(h\), then \(f\) majorizes \(h\).
  Show that if \(f\) and \(g\) majorize each other, then they must be equal.
\end{ex}

\begin{proof}
  We first show that if \(f\) majorizes \(g\) and \(g\) majorizes \(h\), then \(f\) majorizes \(h\).
  Since
  \begin{align*}
             & \forall x \in I, f(x) \geq g(x) \geq h(x) & \text{(by \cref{11.3.1})} \\
    \implies & f(x) \geq h(x),
  \end{align*}
  by \cref{11.3.1} we know that \(f\) majorize \(h\).

  Now we show that if \(f\) and \(g\) majorize each other, then they must be equal.
  Since
  \begin{align*}
             & \forall x \in I, \big(f(x) \geq g(x)\big) \land \big(g(x) \geq f(x)\big) & \text{(by \cref{11.3.1})} \\
    \implies & f(x) = g(x),
  \end{align*}
  by \cref{3.3.7} we know that \(f = g\).
\end{proof}

\begin{ex}\label{ex:11.3.2}
  Let \(f : I \to \R\), \(g : I \to \R\), and \(h : I \to \R\) be functions.
  If \(f\) majorizes \(g\), is it true that \(f + h\) majorizes \(g + h\)?
  Is it true that \(f \cdot h\) majorizes \(g \cdot h\)?
  If \(c\) is a real number, is it true that \(cf\) majorizes \(cg\)?
\end{ex}

\begin{proof}
  We first show that if \(f\) majorizes \(g\), then \(f + h\) majorizes \(g + h\).
  Since
  \begin{align*}
             & \forall x \in I, f(x) \geq g(x) & \text{(by \cref{11.3.1})} \\
    \implies & f(x) + h(x) \geq g(x) + h(x)                                \\
    \implies & (f + h)(x) \geq (g + h)(x),     & \text{(by \cref{9.2.1})}
  \end{align*}
  by \cref{11.3.1} we know that \(f + h\) majorizes \(g + h\).

  Now we show that \(f \cdot h\) may not majorized \(g \cdot h\) and \(cf\) may not majorize \(cg\).
  Let \(c = h(x) = -1\).
  Then we have
  \begin{align*}
             & \forall x \in I, f(x) \geq g(x)                         & \text{(by \cref{11.3.1})} \\
    \implies & cf(x) = f(x) h(x) \leq cg(x) = g(x) h(x)                                            \\
    \implies & (cf)(x) = (f \cdot h)(x) \leq (cg)(x) = (g \cdot h)(x). & \text{(by \cref{9.2.1})}
  \end{align*}
  In this case \(f \cdot h\) does not majorized \(g \cdot h\) and \(cf\) does not majorized \(cg\).
\end{proof}

\begin{ex}\label{ex:11.3.3}
  Prove \cref{11.3.7}.
\end{ex}

\begin{proof}
  See \cref{11.3.7}.
\end{proof}

\begin{ex}\label{ex:11.3.4}
  Prove \cref{11.3.11}.
\end{ex}

\begin{proof}
  See \cref{11.3.11}.
\end{proof}

\begin{ex}\label{ex:11.3.5}
  Prove \cref{11.3.12}.
\end{ex}

\begin{prop}
  See \cref{11.3.12}.
\end{prop}